{"ast":null,"code":"var _jsxFileName = \"/Users/emiliamamedova/charts/project_corona_tracker/src/components/Chart/Chart.jsx\";\nimport React, { useState, useEffect } from 'react';\nimport { Bar, Pie, Line } from 'react-chartjs-2';\n\nconst Analytics = () => {\n  const [activeTab, setActiveTab] = useState('top3');\n  const [top3Data, setTop3Data] = useState([]);\n  const [directionData, setDirectionData] = useState([]);\n  const [punctualityData, setPunctualityData] = useState([]);\n  const [displayCount, setDisplayCount] = useState(10);\n  useEffect(() => {\n    fetch('http://localhost:8000/get_top3').then(res => res.json()).then(data => setTop3Data(data)).catch(console.error);\n    fetch('http://localhost:8000/get_all_direction').then(res => res.json()).then(data => setDirectionData(data)).catch(console.error);\n    fetch('http://localhost:8000/get_airline_punctuality').then(res => res.json()).then(data => setPunctualityData(data)).catch(console.error);\n  }, []);\n  console.log(top3Data, 'top3Data');\n  console.log(directionData, 'directionData');\n  console.log(punctualityData, 'punctualityData'); // 1. Топ 3 авиакомпании - Bar chart\n  // Топ 3 авиакомпании\n\n  const top3ChartData = {\n    labels: top3Data.map(a => a.airline_name || a['Авиакомпания']),\n    datasets: [{\n      label: 'Пунктуальность вылета',\n      backgroundColor: 'rgba(75,192,192,0.6)',\n      data: top3Data.map(a => {\n        var _a$rating_departure;\n\n        return (_a$rating_departure = a.rating_departure) !== null && _a$rating_departure !== void 0 ? _a$rating_departure : a['Отправление'];\n      })\n    }, {\n      label: 'Пунктуальность прилёта',\n      backgroundColor: 'rgba(153,102,255,0.6)',\n      data: top3Data.map(a => {\n        var _a$rating_arrival;\n\n        return (_a$rating_arrival = a.rating_arrival) !== null && _a$rating_arrival !== void 0 ? _a$rating_arrival : a['Прибытие'];\n      })\n    }]\n  }; // Направления - ограничим топ-10\n\n  const topDirections = [...directionData].sort((a, b) => b.total_flights - a.total_flights).slice(0, 10);\n  const directionsLabels = topDirections.map(d => `${d.airport1} → ${d.airport2}`);\n  const directionsCounts = topDirections.map(d => d.total_flights);\n  const directionsChartData = {\n    labels: directionsLabels,\n    datasets: [{\n      label: 'Количество рейсов',\n      data: directionsCounts,\n      backgroundColor: directionsLabels.map(() => `hsl(${Math.floor(Math.random() * 360)}, 70%, 70%)`)\n    }]\n  }; // Пунктуальность - если даты нет, просто покажем среднюю пунктуальность по авиакомпаниям\n\n  const airlines = [...new Set(punctualityData.map(d => d['Авиакомпания']))];\n  const punctualityChartData = {\n    labels: airlines,\n    datasets: [{\n      label: 'Пунктуальность отправления (%)',\n      data: airlines.map(airline => {\n        const rec = punctualityData.find(d => d['Авиакомпания'] === airline);\n        return rec ? rec['Отправление'] : 0;\n      }),\n      backgroundColor: 'rgba(75,192,192,0.6)'\n    }, {\n      label: 'Пунктуальность прибытия (%)',\n      data: airlines.map(airline => {\n        const rec = punctualityData.find(d => d['Авиакомпания'] === airline);\n        return rec ? rec['Прибытие'] : 0;\n      }),\n      backgroundColor: 'rgba(153,102,255,0.6)'\n    }]\n  };\n  const displayedDirections = directionData.slice(0, displayCount);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      maxWidth: 900,\n      margin: '20px auto',\n      fontFamily: 'Arial, sans-serif'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 3\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    style: {\n      textAlign: 'center',\n      marginBottom: 20\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 5\n    }\n  }, \"\\u0410\\u043D\\u0430\\u043B\\u0438\\u0442\\u0438\\u043A\\u0430 \\u0430\\u0432\\u0438\\u0430\\u043A\\u043E\\u043C\\u043F\\u0430\\u043D\\u0438\\u0439 \\u2014 \\u0432\\u044B\\u0431\\u0435\\u0440\\u0438\\u0442\\u0435 \\u0433\\u0440\\u0430\\u0444\\u0438\\u043A\"), /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      display: 'flex',\n      justifyContent: 'center',\n      gap: 15,\n      marginBottom: 30\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    onClick: () => setActiveTab('top3'),\n    disabled: activeTab === 'top3',\n    style: {\n      padding: '10px 20px',\n      borderRadius: 8,\n      border: 'none',\n      cursor: activeTab === 'top3' ? 'default' : 'pointer',\n      backgroundColor: activeTab === 'top3' ? '#4caf50' : '#e0e0e0',\n      color: activeTab === 'top3' ? 'white' : '#333',\n      fontWeight: 'bold',\n      transition: 'background-color 0.3s'\n    },\n    onMouseEnter: e => {\n      if (!e.currentTarget.disabled) e.currentTarget.style.backgroundColor = '#81c784';\n    },\n    onMouseLeave: e => {\n      if (!e.currentTarget.disabled) e.currentTarget.style.backgroundColor = '#e0e0e0';\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 7\n    }\n  }, \"\\u0422\\u043E\\u043F 3 \\u0430\\u0432\\u0438\\u0430\\u043A\\u043E\\u043C\\u043F\\u0430\\u043D\\u0438\\u0438\"), /*#__PURE__*/React.createElement(\"button\", {\n    onClick: () => setActiveTab('directions'),\n    disabled: activeTab === 'directions',\n    style: {\n      padding: '10px 20px',\n      borderRadius: 8,\n      border: 'none',\n      cursor: activeTab === 'directions' ? 'default' : 'pointer',\n      backgroundColor: activeTab === 'directions' ? '#4caf50' : '#e0e0e0',\n      color: activeTab === 'directions' ? 'white' : '#333',\n      fontWeight: 'bold',\n      transition: 'background-color 0.3s'\n    },\n    onMouseEnter: e => {\n      if (!e.currentTarget.disabled) e.currentTarget.style.backgroundColor = '#81c784';\n    },\n    onMouseLeave: e => {\n      if (!e.currentTarget.disabled) e.currentTarget.style.backgroundColor = '#e0e0e0';\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 7\n    }\n  }, \"\\u041D\\u0430\\u043F\\u0440\\u0430\\u0432\\u043B\\u0435\\u043D\\u0438\\u044F\"), /*#__PURE__*/React.createElement(\"button\", {\n    onClick: () => setActiveTab('punctuality'),\n    disabled: activeTab === 'punctuality',\n    style: {\n      padding: '10px 20px',\n      borderRadius: 8,\n      border: 'none',\n      cursor: activeTab === 'punctuality' ? 'default' : 'pointer',\n      backgroundColor: activeTab === 'punctuality' ? '#4caf50' : '#e0e0e0',\n      color: activeTab === 'punctuality' ? 'white' : '#333',\n      fontWeight: 'bold',\n      transition: 'background-color 0.3s'\n    },\n    onMouseEnter: e => {\n      if (!e.currentTarget.disabled) e.currentTarget.style.backgroundColor = '#81c784';\n    },\n    onMouseLeave: e => {\n      if (!e.currentTarget.disabled) e.currentTarget.style.backgroundColor = '#e0e0e0';\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 7\n    }\n  }, \"\\u041F\\u0443\\u043D\\u043A\\u0442\\u0443\\u0430\\u043B\\u044C\\u043D\\u043E\\u0441\\u0442\\u044C\")), activeTab === 'top3' && /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"h3\", {\n    style: {\n      textAlign: 'center',\n      marginBottom: 10\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 176,\n      columnNumber: 9\n    }\n  }, \"\\u0422\\u043E\\u043F 3 \\u0430\\u0432\\u0438\\u0430\\u043A\\u043E\\u043C\\u043F\\u0430\\u043D\\u0438\\u0438 \\u043F\\u043E \\u043F\\u0443\\u043D\\u043A\\u0442\\u0443\\u0430\\u043B\\u044C\\u043D\\u043E\\u0441\\u0442\\u0438\"), /*#__PURE__*/React.createElement(Bar, {\n    data: top3ChartData,\n    options: {\n      responsive: true,\n      plugins: {\n        title: {\n          display: false\n        }\n      }\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177,\n      columnNumber: 9\n    }\n  })), activeTab === 'directions' && /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"h3\", {\n    style: {\n      textAlign: 'center',\n      marginBottom: 10\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 9\n    }\n  }, \"\\u0420\\u0430\\u0441\\u043F\\u0440\\u0435\\u0434\\u0435\\u043B\\u0435\\u043D\\u0438\\u0435 \\u0440\\u0435\\u0439\\u0441\\u043E\\u0432 \\u043F\\u043E \\u043D\\u0430\\u043F\\u0440\\u0430\\u0432\\u043B\\u0435\\u043D\\u0438\\u044F\\u043C (\\u0442\\u043E\\u043F 10)\"), /*#__PURE__*/React.createElement(\"select\", {\n    value: displayCount,\n    onChange: e => setDisplayCount(Number(e.target.value)),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 191,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"option\", {\n    value: 5,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 195,\n      columnNumber: 3\n    }\n  }, \"\\u0422\\u043E\\u043F 5\"), /*#__PURE__*/React.createElement(\"option\", {\n    value: 10,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 3\n    }\n  }, \"\\u0422\\u043E\\u043F 10\"), /*#__PURE__*/React.createElement(\"option\", {\n    value: 20,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 197,\n      columnNumber: 3\n    }\n  }, \"\\u0422\\u043E\\u043F 20\"), /*#__PURE__*/React.createElement(\"option\", {\n    value: 50,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 198,\n      columnNumber: 3\n    }\n  }, \"\\u0422\\u043E\\u043F 50\"), /*#__PURE__*/React.createElement(\"option\", {\n    value: directionData.length,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 199,\n      columnNumber: 3\n    }\n  }, \"\\u0412\\u0441\\u0435\")), /*#__PURE__*/React.createElement(Pie, {\n    data: directionsChartData,\n    options: {\n      responsive: true,\n      plugins: {\n        title: {\n          display: false\n        }\n      }\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 201,\n      columnNumber: 9\n    }\n  })), activeTab === 'punctuality' && /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"h3\", {\n    style: {\n      textAlign: 'center',\n      marginBottom: 10\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 213,\n      columnNumber: 9\n    }\n  }, \"\\u041F\\u0443\\u043D\\u043A\\u0442\\u0443\\u0430\\u043B\\u044C\\u043D\\u043E\\u0441\\u0442\\u044C \\u0430\\u0432\\u0438\\u0430\\u043A\\u043E\\u043C\\u043F\\u0430\\u043D\\u0438\\u0439\"), /*#__PURE__*/React.createElement(Bar, {\n    data: punctualityChartData,\n    options: {\n      responsive: true,\n      plugins: {\n        title: {\n          display: false\n        }\n      },\n      scales: {\n        y: {\n          min: 0,\n          max: 100,\n          title: {\n            display: true,\n            text: 'Пунктуальность (%)'\n          }\n        },\n        x: {\n          title: {\n            display: true,\n            text: 'Авиакомпания'\n          }\n        }\n      }\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 214,\n      columnNumber: 9\n    }\n  })));\n};\n\nexport default Analytics;","map":{"version":3,"sources":["/Users/emiliamamedova/charts/project_corona_tracker/src/components/Chart/Chart.jsx"],"names":["React","useState","useEffect","Bar","Pie","Line","Analytics","activeTab","setActiveTab","top3Data","setTop3Data","directionData","setDirectionData","punctualityData","setPunctualityData","displayCount","setDisplayCount","fetch","then","res","json","data","catch","console","error","log","top3ChartData","labels","map","a","airline_name","datasets","label","backgroundColor","rating_departure","rating_arrival","topDirections","sort","b","total_flights","slice","directionsLabels","d","airport1","airport2","directionsCounts","directionsChartData","Math","floor","random","airlines","Set","punctualityChartData","airline","rec","find","displayedDirections","maxWidth","margin","fontFamily","textAlign","marginBottom","display","justifyContent","gap","padding","borderRadius","border","cursor","color","fontWeight","transition","e","currentTarget","disabled","style","responsive","plugins","title","Number","target","value","length","scales","y","min","max","text","x"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Bar, Pie, Line } from 'react-chartjs-2';\n\nconst Analytics = () => {\n  const [activeTab, setActiveTab] = useState('top3');\n  const [top3Data, setTop3Data] = useState([]);\n  const [directionData, setDirectionData] = useState([]);\n  const [punctualityData, setPunctualityData] = useState([]);\n  const [displayCount, setDisplayCount] = useState(10);\n\n  useEffect(() => {\n    fetch('http://localhost:8000/get_top3')\n      .then(res => res.json())\n      .then(data => setTop3Data(data))\n      .catch(console.error);\n\n    fetch('http://localhost:8000/get_all_direction')\n      .then(res => res.json())\n      .then(data => setDirectionData(data))\n      .catch(console.error);\n\n    fetch('http://localhost:8000/get_airline_punctuality')\n      .then(res => res.json())\n      .then(data => setPunctualityData(data))\n      .catch(console.error);\n  }, []);\n\n  console.log(top3Data, 'top3Data')\n  console.log(directionData, 'directionData')\n  console.log(punctualityData, 'punctualityData')\n\n  // 1. Топ 3 авиакомпании - Bar chart\n  // Топ 3 авиакомпании\nconst top3ChartData = {\n  labels: top3Data.map(a => a.airline_name || a['Авиакомпания']),\n  datasets: [\n    {\n      label: 'Пунктуальность вылета',\n      backgroundColor: 'rgba(75,192,192,0.6)',\n      data: top3Data.map(a => a.rating_departure ?? a['Отправление']),\n    },\n    {\n      label: 'Пунктуальность прилёта',\n      backgroundColor: 'rgba(153,102,255,0.6)',\n      data: top3Data.map(a => a.rating_arrival ?? a['Прибытие']),\n    },\n  ],\n};\n\n// Направления - ограничим топ-10\nconst topDirections = [...directionData]\n  .sort((a, b) => b.total_flights - a.total_flights)\n  .slice(0, 10);\n\nconst directionsLabels = topDirections.map(d => `${d.airport1} → ${d.airport2}`);\nconst directionsCounts = topDirections.map(d => d.total_flights);\n\nconst directionsChartData = {\n  labels: directionsLabels,\n  datasets: [\n    {\n      label: 'Количество рейсов',\n      data: directionsCounts,\n      backgroundColor: directionsLabels.map(\n        () => `hsl(${Math.floor(Math.random() * 360)}, 70%, 70%)`\n      ),\n    },\n  ],\n};\n\n// Пунктуальность - если даты нет, просто покажем среднюю пунктуальность по авиакомпаниям\nconst airlines = [...new Set(punctualityData.map(d => d['Авиакомпания']))];\n\nconst punctualityChartData = {\n  labels: airlines,\n  datasets: [\n    {\n      label: 'Пунктуальность отправления (%)',\n      data: airlines.map(airline => {\n        const rec = punctualityData.find(d => d['Авиакомпания'] === airline);\n        return rec ? rec['Отправление'] : 0;\n      }),\n      backgroundColor: 'rgba(75,192,192,0.6)',\n    },\n    {\n      label: 'Пунктуальность прибытия (%)',\n      data: airlines.map(airline => {\n        const rec = punctualityData.find(d => d['Авиакомпания'] === airline);\n        return rec ? rec['Прибытие'] : 0;\n      }),\n      backgroundColor: 'rgba(153,102,255,0.6)',\n    },\n  ],\n};\n\nconst displayedDirections = directionData.slice(0, displayCount);\n\n\nreturn (\n  <div style={{ maxWidth: 900, margin: '20px auto', fontFamily: 'Arial, sans-serif' }}>\n    <h2 style={{ textAlign: 'center', marginBottom: 20 }}>Аналитика авиакомпаний — выберите график</h2>\n    \n    <div style={{ display: 'flex', justifyContent: 'center', gap: 15, marginBottom: 30 }}>\n      <button\n        onClick={() => setActiveTab('top3')}\n        disabled={activeTab === 'top3'}\n        style={{\n          padding: '10px 20px',\n          borderRadius: 8,\n          border: 'none',\n          cursor: activeTab === 'top3' ? 'default' : 'pointer',\n          backgroundColor: activeTab === 'top3' ? '#4caf50' : '#e0e0e0',\n          color: activeTab === 'top3' ? 'white' : '#333',\n          fontWeight: 'bold',\n          transition: 'background-color 0.3s',\n        }}\n        onMouseEnter={e => {\n          if (!e.currentTarget.disabled) e.currentTarget.style.backgroundColor = '#81c784';\n        }}\n        onMouseLeave={e => {\n          if (!e.currentTarget.disabled) e.currentTarget.style.backgroundColor = '#e0e0e0';\n        }}\n      >\n        Топ 3 авиакомпании\n      </button>\n\n      <button\n        onClick={() => setActiveTab('directions')}\n        disabled={activeTab === 'directions'}\n        style={{\n          padding: '10px 20px',\n          borderRadius: 8,\n          border: 'none',\n          cursor: activeTab === 'directions' ? 'default' : 'pointer',\n          backgroundColor: activeTab === 'directions' ? '#4caf50' : '#e0e0e0',\n          color: activeTab === 'directions' ? 'white' : '#333',\n          fontWeight: 'bold',\n          transition: 'background-color 0.3s',\n        }}\n        onMouseEnter={e => {\n          if (!e.currentTarget.disabled) e.currentTarget.style.backgroundColor = '#81c784';\n        }}\n        onMouseLeave={e => {\n          if (!e.currentTarget.disabled) e.currentTarget.style.backgroundColor = '#e0e0e0';\n        }}\n      >\n        Направления\n      </button>\n\n      <button\n        onClick={() => setActiveTab('punctuality')}\n        disabled={activeTab === 'punctuality'}\n        style={{\n          padding: '10px 20px',\n          borderRadius: 8,\n          border: 'none',\n          cursor: activeTab === 'punctuality' ? 'default' : 'pointer',\n          backgroundColor: activeTab === 'punctuality' ? '#4caf50' : '#e0e0e0',\n          color: activeTab === 'punctuality' ? 'white' : '#333',\n          fontWeight: 'bold',\n          transition: 'background-color 0.3s',\n        }}\n        onMouseEnter={e => {\n          if (!e.currentTarget.disabled) e.currentTarget.style.backgroundColor = '#81c784';\n        }}\n        onMouseLeave={e => {\n          if (!e.currentTarget.disabled) e.currentTarget.style.backgroundColor = '#e0e0e0';\n        }}\n      >\n        Пунктуальность\n      </button>\n    </div>\n\n    {activeTab === 'top3' && (\n      <>\n        <h3 style={{ textAlign: 'center', marginBottom: 10 }}>Топ 3 авиакомпании по пунктуальности</h3>\n        <Bar\n          data={top3ChartData}\n          options={{\n            responsive: true,\n            plugins: { title: { display: false } },\n          }}\n        />\n      </>\n    )}\n\n    {activeTab === 'directions' && (\n      <>\n      \n        <h3 style={{ textAlign: 'center', marginBottom: 10 }}>Распределение рейсов по направлениям (топ 10)</h3>\n        <select\n  value={displayCount}\n  onChange={e => setDisplayCount(Number(e.target.value))}\n>\n  <option value={5}>Топ 5</option>\n  <option value={10}>Топ 10</option>\n  <option value={20}>Топ 20</option>\n  <option value={50}>Топ 50</option>\n  <option value={directionData.length}>Все</option>\n</select>\n        <Pie\n          data={directionsChartData}\n          options={{\n            responsive: true,\n            plugins: { title: { display: false } },\n          }}\n        />\n      </>\n    )}\n\n    {activeTab === 'punctuality' && (\n      <>\n        <h3 style={{ textAlign: 'center', marginBottom: 10 }}>Пунктуальность авиакомпаний</h3>\n        <Bar\n          data={punctualityChartData}\n          options={{\n            responsive: true,\n            plugins: { title: { display: false } },\n            scales: {\n              y: { min: 0, max: 100, title: { display: true, text: 'Пунктуальность (%)' } },\n              x: { title: { display: true, text: 'Авиакомпания' } },\n            },\n          }}\n        />\n      </>\n    )}\n  </div>\n);\n\n};\n\nexport default Analytics;\n"]},"metadata":{},"sourceType":"module"}