{"ast":null,"code":"var _jsxFileName = \"/Users/emiliamamedova/charts/project_corona_tracker/src/components/Chart/Chart.jsx\";\nimport React, { useState, useEffect } from 'react';\nimport { Bar, Pie, Line } from 'react-chartjs-2';\nimport DirectionsCharts from './DirectionCharts/DirectionsCharts';\nimport PunctualityChartWithTable from './PunctualityChart/PunctualityChart';\nimport DelayCharts from './DelayCharts/DelayCharts';\n\nconst Analytics = () => {\n  const [activeTab, setActiveTab] = useState('top3');\n  const [top3Data, setTop3Data] = useState([]);\n  const [directionData, setDirectionData] = useState([]);\n  const [punctualityData, setPunctualityData] = useState([]);\n  const [displayCount, setDisplayCount] = useState(10);\n  useEffect(() => {\n    fetch('http://localhost:8000/get_top3').then(res => res.json()).then(data => setTop3Data(data)).catch(console.error);\n    fetch('http://localhost:8000/get_all_direction').then(res => res.json()).then(data => setDirectionData(data)).catch(console.error);\n    fetch('http://localhost:8000/get_airline_punctuality').then(res => res.json()).then(data => setPunctualityData(data)).catch(console.error);\n  }, []);\n  console.log(top3Data, 'top3Data');\n  console.log(directionData, 'directionData');\n  console.log(punctualityData, 'punctualityData'); // 1. Топ 3 авиакомпании - Bar chart\n  // Топ 3 авиакомпании\n\n  const top3ChartData = {\n    labels: top3Data.map(a => a.airline_name || a['Авиакомпания']),\n    datasets: [{\n      label: 'Пунктуальность вылета',\n      backgroundColor: 'rgba(75,192,192,0.6)',\n      data: top3Data.map(a => {\n        var _a$rating_departure;\n\n        return (_a$rating_departure = a.rating_departure) !== null && _a$rating_departure !== void 0 ? _a$rating_departure : a['Отправление'];\n      })\n    }, {\n      label: 'Пунктуальность прилёта',\n      backgroundColor: 'rgba(153,102,255,0.6)',\n      data: top3Data.map(a => {\n        var _a$rating_arrival;\n\n        return (_a$rating_arrival = a.rating_arrival) !== null && _a$rating_arrival !== void 0 ? _a$rating_arrival : a['Прибытие'];\n      })\n    }]\n  }; // Направления - ограничим топ-10\n\n  const topDirections = [...directionData].sort((a, b) => b.total_flights - a.total_flights).slice(0, 10);\n  const displayedDirections = directionData.slice(0, displayCount);\n  const directionsLabels = displayedDirections.map(d => `${d.airport1} → ${d.airport2}`);\n  const directionsCounts = displayedDirections.map(d => d.total_flights);\n  const directionsChartData = {\n    labels: directionsLabels,\n    datasets: [{\n      label: 'Количество рейсов',\n      data: directionsCounts,\n      backgroundColor: directionsLabels.map(() => `hsl(${Math.floor(Math.random() * 360)}, 70%, 70%)`)\n    }]\n  };\n  const directionsChartOptions = {\n    responsive: true,\n    plugins: {\n      tooltip: {\n        callbacks: {\n          label: context => {\n            var _item$on_time_percent;\n\n            const idx = context.dataIndex;\n            const item = displayedDirections[idx];\n            return [`Рейсов: ${item.total_flights}`, `Пунктуальность: ${(_item$on_time_percent = item.on_time_percentage) !== null && _item$on_time_percent !== void 0 ? _item$on_time_percent : 'н/д'}%`];\n          }\n        }\n      },\n      legend: {\n        display: false\n      }\n    }\n  }; // Пунктуальность - если даты нет, просто покажем среднюю пунктуальность по авиакомпаниям\n\n  const airlines = [...new Set(punctualityData.map(d => d['Авиакомпания']))];\n  const punctualityChartData = {\n    labels: airlines,\n    datasets: [{\n      label: 'Пунктуальность отправления (%)',\n      data: airlines.map(airline => {\n        const rec = punctualityData.find(d => d['Авиакомпания'] === airline);\n        return rec ? rec['Отправление'] : 0;\n      }),\n      backgroundColor: 'rgba(75,192,192,0.6)'\n    }, {\n      label: 'Пунктуальность прибытия (%)',\n      data: airlines.map(airline => {\n        const rec = punctualityData.find(d => d['Авиакомпания'] === airline);\n        return rec ? rec['Прибытие'] : 0;\n      }),\n      backgroundColor: 'rgba(153,102,255,0.6)'\n    }]\n  };\n  return /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      maxWidth: 1000,\n      margin: '20px auto',\n      fontFamily: 'Arial, sans-serif'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 3\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      display: 'flex',\n      justifyContent: 'center',\n      gap: 15\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    onClick: () => setActiveTab('top3'),\n    disabled: activeTab === 'top3',\n    style: {\n      padding: '10px 20px',\n      borderRadius: 8,\n      border: 'none',\n      cursor: activeTab === 'top3' ? 'default' : 'pointer',\n      backgroundColor: activeTab === 'top3' ? '#00539c' : '#e0e0e0',\n      color: activeTab === 'top3' ? 'white' : '#333',\n      fontWeight: 'bold',\n      transition: 'background-color 0.3s'\n    },\n    onMouseEnter: e => {\n      if (!e.currentTarget.disabled) e.currentTarget.style.backgroundColor = '#81c784';\n    },\n    onMouseLeave: e => {\n      if (!e.currentTarget.disabled) e.currentTarget.style.backgroundColor = '#e0e0e0';\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 7\n    }\n  }, \"\\u0417\\u0430\\u0434\\u0435\\u0440\\u0436\\u043A\\u0438\"), /*#__PURE__*/React.createElement(\"button\", {\n    onClick: () => setActiveTab('directions'),\n    disabled: activeTab === 'directions',\n    style: {\n      padding: '10px 20px',\n      borderRadius: 8,\n      border: 'none',\n      cursor: activeTab === 'directions' ? 'default' : 'pointer',\n      backgroundColor: activeTab === 'directions' ? '#00539c' : '#e0e0e0',\n      color: activeTab === 'directions' ? 'white' : '#333',\n      fontWeight: 'bold',\n      transition: 'background-color 0.3s'\n    },\n    onMouseEnter: e => {\n      if (!e.currentTarget.disabled) e.currentTarget.style.backgroundColor = '#81c784';\n    },\n    onMouseLeave: e => {\n      if (!e.currentTarget.disabled) e.currentTarget.style.backgroundColor = '#e0e0e0';\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 7\n    }\n  }, \"\\u041D\\u0430\\u043F\\u0440\\u0430\\u0432\\u043B\\u0435\\u043D\\u0438\\u044F\"), /*#__PURE__*/React.createElement(\"button\", {\n    onClick: () => setActiveTab('punctuality'),\n    disabled: activeTab === 'punctuality',\n    style: {\n      padding: '10px 20px',\n      borderRadius: 8,\n      border: 'none',\n      cursor: activeTab === 'punctuality' ? 'default' : 'pointer',\n      backgroundColor: activeTab === 'punctuality' ? '#00539c' : '#e0e0e0',\n      color: activeTab === 'punctuality' ? 'white' : '#333',\n      fontWeight: 'bold',\n      transition: 'background-color 0.3s'\n    },\n    onMouseEnter: e => {\n      if (!e.currentTarget.disabled) e.currentTarget.style.backgroundColor = '#81c784';\n    },\n    onMouseLeave: e => {\n      if (!e.currentTarget.disabled) e.currentTarget.style.backgroundColor = '#e0e0e0';\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 7\n    }\n  }, \"\\u0410\\u0432\\u0438\\u0430\\u043A\\u043E\\u043C\\u043F\\u0430\\u043D\\u0438\\u0438\")), activeTab === 'top3' && /*#__PURE__*/React.createElement(DelayCharts, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 193,\n      columnNumber: 31\n    }\n  }), activeTab === 'directions' && /*#__PURE__*/React.createElement(DirectionsCharts, {\n    directionData: directionData,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 34\n    }\n  }), activeTab === 'punctuality' && /*#__PURE__*/React.createElement(PunctualityChartWithTable, {\n    data: punctualityData,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 199,\n      columnNumber: 7\n    }\n  }));\n};\n\nexport default Analytics;","map":{"version":3,"sources":["/Users/emiliamamedova/charts/project_corona_tracker/src/components/Chart/Chart.jsx"],"names":["React","useState","useEffect","Bar","Pie","Line","DirectionsCharts","PunctualityChartWithTable","DelayCharts","Analytics","activeTab","setActiveTab","top3Data","setTop3Data","directionData","setDirectionData","punctualityData","setPunctualityData","displayCount","setDisplayCount","fetch","then","res","json","data","catch","console","error","log","top3ChartData","labels","map","a","airline_name","datasets","label","backgroundColor","rating_departure","rating_arrival","topDirections","sort","b","total_flights","slice","displayedDirections","directionsLabels","d","airport1","airport2","directionsCounts","directionsChartData","Math","floor","random","directionsChartOptions","responsive","plugins","tooltip","callbacks","context","idx","dataIndex","item","on_time_percentage","legend","display","airlines","Set","punctualityChartData","airline","rec","find","maxWidth","margin","fontFamily","justifyContent","gap","padding","borderRadius","border","cursor","color","fontWeight","transition","e","currentTarget","disabled","style"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Bar, Pie, Line } from 'react-chartjs-2';\nimport DirectionsCharts from './DirectionCharts/DirectionsCharts';\nimport PunctualityChartWithTable from './PunctualityChart/PunctualityChart';\nimport DelayCharts from './DelayCharts/DelayCharts';\n\nconst Analytics = () => {\n  const [activeTab, setActiveTab] = useState('top3');\n  const [top3Data, setTop3Data] = useState([]);\n  const [directionData, setDirectionData] = useState([]);\n  const [punctualityData, setPunctualityData] = useState([]);\n  const [displayCount, setDisplayCount] = useState(10);\n\n  useEffect(() => {\n    fetch('http://localhost:8000/get_top3')\n      .then(res => res.json())\n      .then(data => setTop3Data(data))\n      .catch(console.error);\n\n    fetch('http://localhost:8000/get_all_direction')\n      .then(res => res.json())\n      .then(data => setDirectionData(data))\n      .catch(console.error);\n\n    fetch('http://localhost:8000/get_airline_punctuality')\n      .then(res => res.json())\n      .then(data => setPunctualityData(data))\n      .catch(console.error);\n  }, []);\n\n  console.log(top3Data, 'top3Data')\n  console.log(directionData, 'directionData')\n  console.log(punctualityData, 'punctualityData')\n\n  // 1. Топ 3 авиакомпании - Bar chart\n  // Топ 3 авиакомпании\nconst top3ChartData = {\n  labels: top3Data.map(a => a.airline_name || a['Авиакомпания']),\n  datasets: [\n    {\n      label: 'Пунктуальность вылета',\n      backgroundColor: 'rgba(75,192,192,0.6)',\n      data: top3Data.map(a => a.rating_departure ?? a['Отправление']),\n    },\n    {\n      label: 'Пунктуальность прилёта',\n      backgroundColor: 'rgba(153,102,255,0.6)',\n      data: top3Data.map(a => a.rating_arrival ?? a['Прибытие']),\n    },\n  ],\n};\n\n// Направления - ограничим топ-10\nconst topDirections = [...directionData]\n  .sort((a, b) => b.total_flights - a.total_flights)\n  .slice(0, 10);\n\n  const displayedDirections = directionData.slice(0, displayCount);\n\n  const directionsLabels = displayedDirections.map(d => `${d.airport1} → ${d.airport2}`);\n  const directionsCounts = displayedDirections.map(d => d.total_flights);\n  \n  const directionsChartData = {\n    labels: directionsLabels,\n    datasets: [{\n      label: 'Количество рейсов',\n      data: directionsCounts,\n      backgroundColor: directionsLabels.map(() =>\n        `hsl(${Math.floor(Math.random() * 360)}, 70%, 70%)`\n      ),\n    }],\n  };\n\n  const directionsChartOptions = {\n    responsive: true,\n    plugins: {\n      tooltip: {\n        callbacks: {\n          label: context => {\n            const idx = context.dataIndex;\n            const item = displayedDirections[idx];\n            return [\n              `Рейсов: ${item.total_flights}`,\n              `Пунктуальность: ${item.on_time_percentage ?? 'н/д'}%`\n            ];\n          }\n        }\n      },\n      legend: { display: false }\n    }\n  };\n  \n// Пунктуальность - если даты нет, просто покажем среднюю пунктуальность по авиакомпаниям\nconst airlines = [...new Set(punctualityData.map(d => d['Авиакомпания']))];\n\nconst punctualityChartData = {\n  labels: airlines,\n  datasets: [\n    {\n      label: 'Пунктуальность отправления (%)',\n      data: airlines.map(airline => {\n        const rec = punctualityData.find(d => d['Авиакомпания'] === airline);\n        return rec ? rec['Отправление'] : 0;\n      }),\n      backgroundColor: 'rgba(75,192,192,0.6)',\n    },\n    {\n      label: 'Пунктуальность прибытия (%)',\n      data: airlines.map(airline => {\n        const rec = punctualityData.find(d => d['Авиакомпания'] === airline);\n        return rec ? rec['Прибытие'] : 0;\n      }),\n      backgroundColor: 'rgba(153,102,255,0.6)',\n    },\n  ],\n};\n\n\n\nreturn (\n  <div style={{ maxWidth: 1000, margin: '20px auto', fontFamily: 'Arial, sans-serif' }}>    \n    <div style={{ display: 'flex', justifyContent: 'center', gap: 15 }}>\n      <button\n        onClick={() => setActiveTab('top3')}\n        disabled={activeTab === 'top3'}\n        style={{\n          padding: '10px 20px',\n          borderRadius: 8,\n          border: 'none',\n          cursor: activeTab === 'top3' ? 'default' : 'pointer',\n          backgroundColor: activeTab === 'top3' ? '#00539c' : '#e0e0e0',\n          color: activeTab === 'top3' ? 'white' : '#333',\n          fontWeight: 'bold',\n          transition: 'background-color 0.3s',\n        }}\n        onMouseEnter={e => {\n          if (!e.currentTarget.disabled) e.currentTarget.style.backgroundColor = '#81c784';\n        }}\n        onMouseLeave={e => {\n          if (!e.currentTarget.disabled) e.currentTarget.style.backgroundColor = '#e0e0e0';\n        }}\n      >\n        Задержки\n      </button>\n\n      <button\n        onClick={() => setActiveTab('directions')}\n        disabled={activeTab === 'directions'}\n        style={{\n          padding: '10px 20px',\n          borderRadius: 8,\n          border: 'none',\n          cursor: activeTab === 'directions' ? 'default' : 'pointer',\n          backgroundColor: activeTab === 'directions' ? '#00539c' : '#e0e0e0',\n          color: activeTab === 'directions' ? 'white' : '#333',\n          fontWeight: 'bold',\n          transition: 'background-color 0.3s',\n        }}\n        onMouseEnter={e => {\n          if (!e.currentTarget.disabled) e.currentTarget.style.backgroundColor = '#81c784';\n        }}\n        onMouseLeave={e => {\n          if (!e.currentTarget.disabled) e.currentTarget.style.backgroundColor = '#e0e0e0';\n        }}\n      >\n        Направления\n      </button>\n\n      <button\n        onClick={() => setActiveTab('punctuality')}\n        disabled={activeTab === 'punctuality'}\n        style={{\n          padding: '10px 20px',\n          borderRadius: 8,\n          border: 'none',\n          cursor: activeTab === 'punctuality' ? 'default' : 'pointer',\n          backgroundColor: activeTab === 'punctuality' ? '#00539c' : '#e0e0e0',\n          color: activeTab === 'punctuality' ? 'white' : '#333',\n          fontWeight: 'bold',\n          transition: 'background-color 0.3s',\n        }}\n        onMouseEnter={e => {\n          if (!e.currentTarget.disabled) e.currentTarget.style.backgroundColor = '#81c784';\n        }}\n        onMouseLeave={e => {\n          if (!e.currentTarget.disabled) e.currentTarget.style.backgroundColor = '#e0e0e0';\n        }}\n      >\n        Авиакомпании\n      </button>\n    </div>\n\n    {activeTab === 'top3' && (<DelayCharts />\n    )}\n\n{activeTab === 'directions' && ( <DirectionsCharts directionData={directionData} />\n)}\n    {activeTab === 'punctuality' && (\n      <PunctualityChartWithTable data={punctualityData}/>\n    )}\n  </div>\n);\n\n};\n\nexport default Analytics;\n"]},"metadata":{},"sourceType":"module"}