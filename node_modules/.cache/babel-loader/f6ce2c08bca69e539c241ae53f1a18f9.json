{"ast":null,"code":"var _excluded = [\"sourceX\", \"sourceY\", \"sourceControlX\", \"targetX\", \"targetY\", \"targetControlX\", \"linkWidth\"],\n    _excluded2 = [\"width\", \"height\", \"className\", \"style\", \"children\"];\n\nfunction _extends() {\n  return _extends = Object.assign ? Object.assign.bind() : function (n) {\n    for (var e = 1; e < arguments.length; e++) {\n      var t = arguments[e];\n\n      for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]);\n    }\n\n    return n;\n  }, _extends.apply(null, arguments);\n}\n\nfunction _objectWithoutProperties(e, t) {\n  if (null == e) return {};\n\n  var o,\n      r,\n      i = _objectWithoutPropertiesLoose(e, t);\n\n  if (Object.getOwnPropertySymbols) {\n    var n = Object.getOwnPropertySymbols(e);\n\n    for (r = 0; r < n.length; r++) o = n[r], -1 === t.indexOf(o) && {}.propertyIsEnumerable.call(e, o) && (i[o] = e[o]);\n  }\n\n  return i;\n}\n\nfunction _objectWithoutPropertiesLoose(r, e) {\n  if (null == r) return {};\n  var t = {};\n\n  for (var n in r) if ({}.hasOwnProperty.call(r, n)) {\n    if (-1 !== e.indexOf(n)) continue;\n    t[n] = r[n];\n  }\n\n  return t;\n}\n\nfunction ownKeys(e, r) {\n  var t = Object.keys(e);\n\n  if (Object.getOwnPropertySymbols) {\n    var o = Object.getOwnPropertySymbols(e);\n    r && (o = o.filter(function (r) {\n      return Object.getOwnPropertyDescriptor(e, r).enumerable;\n    })), t.push.apply(t, o);\n  }\n\n  return t;\n}\n\nfunction _objectSpread(e) {\n  for (var r = 1; r < arguments.length; r++) {\n    var t = null != arguments[r] ? arguments[r] : {};\n    r % 2 ? ownKeys(Object(t), !0).forEach(function (r) {\n      _defineProperty(e, r, t[r]);\n    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) {\n      Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r));\n    });\n  }\n\n  return e;\n}\n\nfunction _defineProperty(e, r, t) {\n  return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, {\n    value: t,\n    enumerable: !0,\n    configurable: !0,\n    writable: !0\n  }) : e[r] = t, e;\n}\n\nfunction _toPropertyKey(t) {\n  var i = _toPrimitive(t, \"string\");\n\n  return \"symbol\" == typeof i ? i : i + \"\";\n}\n\nfunction _toPrimitive(t, r) {\n  if (\"object\" != typeof t || !t) return t;\n  var e = t[Symbol.toPrimitive];\n\n  if (void 0 !== e) {\n    var i = e.call(t, r || \"default\");\n    if (\"object\" != typeof i) return i;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n\n  return (\"string\" === r ? String : Number)(t);\n}\n\nimport * as React from 'react';\nimport { PureComponent } from 'react';\nimport maxBy from 'es-toolkit/compat/maxBy';\nimport sumBy from 'es-toolkit/compat/sumBy';\nimport get from 'es-toolkit/compat/get';\nimport { Surface } from '../container/Surface';\nimport { Layer } from '../container/Layer';\nimport { Rectangle } from '../shape/Rectangle';\nimport { shallowEqual } from '../util/ShallowEqual';\nimport { filterProps } from '../util/ReactUtils';\nimport { getValueByDataKey } from '../util/ChartUtils';\nimport { ReportChartMargin, ReportChartSize } from '../context/chartLayoutContext';\nimport { TooltipPortalContext } from '../context/tooltipPortalContext';\nimport { RechartsWrapper } from './RechartsWrapper';\nimport { RechartsStoreProvider } from '../state/RechartsStoreProvider';\nimport { useAppDispatch } from '../state/hooks';\nimport { mouseLeaveItem, setActiveClickItemIndex, setActiveMouseOverItemIndex } from '../state/tooltipSlice';\nimport { SetTooltipEntrySettings } from '../state/SetTooltipEntrySettings';\nimport { SetComputedData } from '../context/chartDataContext';\nimport { isPositiveNumber } from '../util/isWellBehavedNumber';\n\nvar interpolationGenerator = (a, b) => {\n  var ka = +a;\n  var kb = b - ka;\n  return t => ka + kb * t;\n};\n\nvar centerY = node => node.y + node.dy / 2;\n\nvar getValue = entry => entry && entry.value || 0;\n\nvar getSumOfIds = (links, ids) => ids.reduce((result, id) => result + getValue(links[id]), 0);\n\nvar getSumWithWeightedSource = (tree, links, ids) => ids.reduce((result, id) => {\n  var link = links[id];\n  var sourceNode = tree[link.source];\n  return result + centerY(sourceNode) * getValue(links[id]);\n}, 0);\n\nvar getSumWithWeightedTarget = (tree, links, ids) => ids.reduce((result, id) => {\n  var link = links[id];\n  var targetNode = tree[link.target];\n  return result + centerY(targetNode) * getValue(links[id]);\n}, 0);\n\nvar ascendingY = (a, b) => a.y - b.y;\n\nvar searchTargetsAndSources = (links, id) => {\n  var sourceNodes = [];\n  var sourceLinks = [];\n  var targetNodes = [];\n  var targetLinks = [];\n\n  for (var i = 0, len = links.length; i < len; i++) {\n    var link = links[i];\n\n    if (link.source === id) {\n      targetNodes.push(link.target);\n      targetLinks.push(i);\n    }\n\n    if (link.target === id) {\n      sourceNodes.push(link.source);\n      sourceLinks.push(i);\n    }\n  }\n\n  return {\n    sourceNodes,\n    sourceLinks,\n    targetLinks,\n    targetNodes\n  };\n};\n\nvar updateDepthOfTargets = (tree, curNode) => {\n  var {\n    targetNodes\n  } = curNode;\n\n  for (var i = 0, len = targetNodes.length; i < len; i++) {\n    var target = tree[targetNodes[i]];\n\n    if (target) {\n      target.depth = Math.max(curNode.depth + 1, target.depth);\n      updateDepthOfTargets(tree, target);\n    }\n  }\n};\n\nvar getNodesTree = (_ref, width, nodeWidth) => {\n  var {\n    nodes,\n    links\n  } = _ref;\n  var tree = nodes.map((entry, index) => {\n    var result = searchTargetsAndSources(links, index);\n    return _objectSpread(_objectSpread(_objectSpread({}, entry), result), {}, {\n      value: Math.max(getSumOfIds(links, result.sourceLinks), getSumOfIds(links, result.targetLinks)),\n      depth: 0\n    });\n  });\n\n  for (var i = 0, len = tree.length; i < len; i++) {\n    var node = tree[i];\n\n    if (!node.sourceNodes.length) {\n      updateDepthOfTargets(tree, node);\n    }\n  }\n\n  var maxDepth = maxBy(tree, entry => entry.depth).depth;\n\n  if (maxDepth >= 1) {\n    var childWidth = (width - nodeWidth) / maxDepth;\n\n    for (var _i = 0, _len = tree.length; _i < _len; _i++) {\n      var _node = tree[_i];\n\n      if (!_node.targetNodes.length) {\n        _node.depth = maxDepth;\n      }\n\n      _node.x = _node.depth * childWidth;\n      _node.dx = nodeWidth;\n    }\n  }\n\n  return {\n    tree,\n    maxDepth\n  };\n};\n\nvar getDepthTree = tree => {\n  var result = [];\n\n  for (var i = 0, len = tree.length; i < len; i++) {\n    var node = tree[i];\n\n    if (!result[node.depth]) {\n      result[node.depth] = [];\n    }\n\n    result[node.depth].push(node);\n  }\n\n  return result;\n};\n\nvar updateYOfTree = (depthTree, height, nodePadding, links) => {\n  var yRatio = Math.min(...depthTree.map(nodes => (height - (nodes.length - 1) * nodePadding) / sumBy(nodes, getValue)));\n\n  for (var d = 0, maxDepth = depthTree.length; d < maxDepth; d++) {\n    for (var i = 0, len = depthTree[d].length; i < len; i++) {\n      var node = depthTree[d][i];\n      node.y = i;\n      node.dy = node.value * yRatio;\n    }\n  }\n\n  return links.map(link => _objectSpread(_objectSpread({}, link), {}, {\n    dy: getValue(link) * yRatio\n  }));\n};\n\nvar resolveCollisions = function resolveCollisions(depthTree, height, nodePadding) {\n  var sort = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : true;\n\n  for (var i = 0, len = depthTree.length; i < len; i++) {\n    var nodes = depthTree[i];\n    var n = nodes.length; // Sort by the value of y\n\n    if (sort) {\n      nodes.sort(ascendingY);\n    }\n\n    var y0 = 0;\n\n    for (var j = 0; j < n; j++) {\n      var node = nodes[j];\n      var dy = y0 - node.y;\n\n      if (dy > 0) {\n        node.y += dy;\n      }\n\n      y0 = node.y + node.dy + nodePadding;\n    }\n\n    y0 = height + nodePadding;\n\n    for (var _j = n - 1; _j >= 0; _j--) {\n      var _node2 = nodes[_j];\n\n      var _dy = _node2.y + _node2.dy + nodePadding - y0;\n\n      if (_dy > 0) {\n        _node2.y -= _dy;\n        y0 = _node2.y;\n      } else {\n        break;\n      }\n    }\n  }\n};\n\nvar relaxLeftToRight = (tree, depthTree, links, alpha) => {\n  for (var i = 0, maxDepth = depthTree.length; i < maxDepth; i++) {\n    var nodes = depthTree[i];\n\n    for (var j = 0, len = nodes.length; j < len; j++) {\n      var node = nodes[j];\n\n      if (node.sourceLinks.length) {\n        var sourceSum = getSumOfIds(links, node.sourceLinks);\n        var weightedSum = getSumWithWeightedSource(tree, links, node.sourceLinks);\n        var y = weightedSum / sourceSum;\n        node.y += (y - centerY(node)) * alpha;\n      }\n    }\n  }\n};\n\nvar relaxRightToLeft = (tree, depthTree, links, alpha) => {\n  for (var i = depthTree.length - 1; i >= 0; i--) {\n    var nodes = depthTree[i];\n\n    for (var j = 0, len = nodes.length; j < len; j++) {\n      var node = nodes[j];\n\n      if (node.targetLinks.length) {\n        var targetSum = getSumOfIds(links, node.targetLinks);\n        var weightedSum = getSumWithWeightedTarget(tree, links, node.targetLinks);\n        var y = weightedSum / targetSum;\n        node.y += (y - centerY(node)) * alpha;\n      }\n    }\n  }\n};\n\nvar updateYOfLinks = (tree, links) => {\n  for (var i = 0, len = tree.length; i < len; i++) {\n    var node = tree[i];\n    var sy = 0;\n    var ty = 0;\n    node.targetLinks.sort((a, b) => tree[links[a].target].y - tree[links[b].target].y);\n    node.sourceLinks.sort((a, b) => tree[links[a].source].y - tree[links[b].source].y);\n\n    for (var j = 0, tLen = node.targetLinks.length; j < tLen; j++) {\n      var link = links[node.targetLinks[j]];\n\n      if (link) {\n        link.sy = sy;\n        sy += link.dy;\n      }\n    }\n\n    for (var _j2 = 0, sLen = node.sourceLinks.length; _j2 < sLen; _j2++) {\n      var _link = links[node.sourceLinks[_j2]];\n\n      if (_link) {\n        _link.ty = ty;\n        ty += _link.dy;\n      }\n    }\n  }\n};\n\nvar computeData = _ref2 => {\n  var {\n    data,\n    width,\n    height,\n    iterations,\n    nodeWidth,\n    nodePadding,\n    sort\n  } = _ref2;\n  var {\n    links\n  } = data;\n  var {\n    tree\n  } = getNodesTree(data, width, nodeWidth);\n  var depthTree = getDepthTree(tree);\n  var newLinks = updateYOfTree(depthTree, height, nodePadding, links);\n  resolveCollisions(depthTree, height, nodePadding, sort);\n  var alpha = 1;\n\n  for (var i = 1; i <= iterations; i++) {\n    relaxRightToLeft(tree, depthTree, newLinks, alpha *= 0.99);\n    resolveCollisions(depthTree, height, nodePadding, sort);\n    relaxLeftToRight(tree, depthTree, newLinks, alpha);\n    resolveCollisions(depthTree, height, nodePadding, sort);\n  }\n\n  updateYOfLinks(tree, newLinks);\n  return {\n    nodes: tree,\n    links: newLinks\n  };\n};\n\nvar getCoordinateOfTooltip = (item, type) => {\n  if (type === 'node') {\n    return {\n      x: +item.x + +item.width / 2,\n      y: +item.y + +item.height / 2\n    };\n  }\n\n  return 'sourceX' in item && {\n    x: (item.sourceX + item.targetX) / 2,\n    y: (item.sourceY + item.targetY) / 2\n  };\n};\n\nvar getPayloadOfTooltip = (item, type, nameKey) => {\n  var {\n    payload\n  } = item;\n\n  if (type === 'node') {\n    return {\n      payload,\n      name: getValueByDataKey(payload, nameKey, ''),\n      value: getValueByDataKey(payload, 'value')\n    };\n  }\n\n  if ('source' in payload && payload.source && payload.target) {\n    var sourceName = getValueByDataKey(payload.source, nameKey, '');\n    var targetName = getValueByDataKey(payload.target, nameKey, '');\n    return {\n      payload,\n      name: \"\".concat(sourceName, \" - \").concat(targetName),\n      value: getValueByDataKey(payload, 'value')\n    };\n  }\n\n  return null;\n};\n\nexport var sankeyPayloadSearcher = (_, activeIndex, computedData, nameKey) => {\n  if (activeIndex == null || typeof activeIndex !== 'string') {\n    return undefined;\n  }\n\n  var splitIndex = activeIndex.split('-');\n  var [targetType, index] = splitIndex;\n  var item = get(computedData, \"\".concat(targetType, \"s[\").concat(index, \"]\"));\n\n  if (item) {\n    var payload = getPayloadOfTooltip(item, targetType, nameKey);\n    return payload;\n  }\n\n  return undefined;\n};\nvar options = {\n  chartName: 'Sankey',\n  defaultTooltipEventType: 'item',\n  validateTooltipEventTypes: ['item'],\n  tooltipPayloadSearcher: sankeyPayloadSearcher,\n  eventEmitter: undefined\n};\n\nfunction getTooltipEntrySettings(props) {\n  var {\n    dataKey,\n    nameKey,\n    stroke,\n    strokeWidth,\n    fill,\n    name,\n    data\n  } = props;\n  return {\n    dataDefinedOnItem: data,\n    positions: undefined,\n    settings: {\n      stroke,\n      strokeWidth,\n      fill,\n      dataKey,\n      name,\n      nameKey,\n      color: fill,\n      unit: '' // Sankey does not have unit, why?\n\n    }\n  };\n} // TODO: improve types - NodeOptions uses SankeyNode, LinkOptions uses LinkProps. Standardize.\n// Why is margin not a Sankey prop? No clue. Probably it should be\n\n\nvar defaultSankeyMargin = {\n  top: 0,\n  right: 0,\n  bottom: 0,\n  left: 0\n};\n\nfunction renderLinkItem(option, props) {\n  if ( /*#__PURE__*/React.isValidElement(option)) {\n    return /*#__PURE__*/React.cloneElement(option, props);\n  }\n\n  if (typeof option === 'function') {\n    return option(props);\n  }\n\n  var {\n    sourceX,\n    sourceY,\n    sourceControlX,\n    targetX,\n    targetY,\n    targetControlX,\n    linkWidth\n  } = props,\n      others = _objectWithoutProperties(props, _excluded);\n\n  return /*#__PURE__*/React.createElement(\"path\", _extends({\n    className: \"recharts-sankey-link\",\n    d: \"\\n          M\".concat(sourceX, \",\").concat(sourceY, \"\\n          C\").concat(sourceControlX, \",\").concat(sourceY, \" \").concat(targetControlX, \",\").concat(targetY, \" \").concat(targetX, \",\").concat(targetY, \"\\n        \"),\n    fill: \"none\",\n    stroke: \"#333\",\n    strokeWidth: linkWidth,\n    strokeOpacity: \"0.2\"\n  }, filterProps(others, false)));\n}\n\nvar buildLinkProps = _ref3 => {\n  var {\n    link,\n    nodes,\n    left,\n    top,\n    i,\n    linkContent,\n    linkCurvature\n  } = _ref3;\n  var {\n    sy: sourceRelativeY,\n    ty: targetRelativeY,\n    dy: linkWidth\n  } = link;\n  var sourceNode = nodes[link.source];\n  var targetNode = nodes[link.target];\n  var sourceX = sourceNode.x + sourceNode.dx + left;\n  var targetX = targetNode.x + left;\n  var interpolationFunc = interpolationGenerator(sourceX, targetX);\n  var sourceControlX = interpolationFunc(linkCurvature);\n  var targetControlX = interpolationFunc(1 - linkCurvature);\n  var sourceY = sourceNode.y + sourceRelativeY + linkWidth / 2 + top;\n  var targetY = targetNode.y + targetRelativeY + linkWidth / 2 + top;\n\n  var linkProps = _objectSpread({\n    sourceX,\n    targetX,\n    sourceY,\n    targetY,\n    sourceControlX,\n    targetControlX,\n    sourceRelativeY,\n    targetRelativeY,\n    linkWidth,\n    index: i,\n    payload: _objectSpread(_objectSpread({}, link), {}, {\n      source: sourceNode,\n      target: targetNode\n    })\n  }, filterProps(linkContent, false));\n\n  return linkProps;\n};\n\nfunction SankeyLinkElement(_ref4) {\n  var {\n    props,\n    i,\n    linkContent,\n    onMouseEnter: _onMouseEnter,\n    onMouseLeave: _onMouseLeave,\n    onClick: _onClick,\n    dataKey\n  } = _ref4;\n  var activeCoordinate = getCoordinateOfTooltip(props, 'link');\n  var activeIndex = \"link-\".concat(i);\n  var dispatch = useAppDispatch();\n  var events = {\n    onMouseEnter: e => {\n      dispatch(setActiveMouseOverItemIndex({\n        activeIndex,\n        activeDataKey: dataKey,\n        activeCoordinate\n      }));\n\n      _onMouseEnter(props, e);\n    },\n    onMouseLeave: e => {\n      dispatch(mouseLeaveItem());\n\n      _onMouseLeave(props, e);\n    },\n    onClick: e => {\n      dispatch(setActiveClickItemIndex({\n        activeIndex,\n        activeDataKey: dataKey,\n        activeCoordinate\n      }));\n\n      _onClick(props, e);\n    }\n  };\n  return /*#__PURE__*/React.createElement(Layer, events, renderLinkItem(linkContent, props));\n}\n\nfunction AllSankeyLinkElements(_ref5) {\n  var {\n    modifiedLinks,\n    links,\n    linkContent,\n    onMouseEnter,\n    onMouseLeave,\n    onClick,\n    dataKey\n  } = _ref5;\n  return /*#__PURE__*/React.createElement(Layer, {\n    className: \"recharts-sankey-links\",\n    key: \"recharts-sankey-links\"\n  }, links.map((link, i) => {\n    var linkProps = modifiedLinks[i];\n    return /*#__PURE__*/React.createElement(SankeyLinkElement, {\n      key: \"link-\".concat(link.source, \"-\").concat(link.target, \"-\").concat(link.value),\n      props: linkProps,\n      linkContent: linkContent,\n      i: i,\n      onMouseEnter: onMouseEnter,\n      onMouseLeave: onMouseLeave,\n      onClick: onClick,\n      dataKey: dataKey\n    });\n  }));\n}\n\nfunction renderNodeItem(option, props) {\n  if ( /*#__PURE__*/React.isValidElement(option)) {\n    return /*#__PURE__*/React.cloneElement(option, props);\n  }\n\n  if (typeof option === 'function') {\n    return option(props);\n  }\n\n  return /*#__PURE__*/React.createElement(Rectangle, _extends({\n    className: \"recharts-sankey-node\",\n    fill: \"#0088fe\",\n    fillOpacity: \"0.8\"\n  }, filterProps(props, false)));\n}\n\nvar buildNodeProps = _ref6 => {\n  var {\n    node,\n    nodeContent,\n    top,\n    left,\n    i\n  } = _ref6;\n  var {\n    x,\n    y,\n    dx,\n    dy\n  } = node;\n\n  var nodeProps = _objectSpread(_objectSpread({}, filterProps(nodeContent, false)), {}, {\n    x: x + left,\n    y: y + top,\n    width: dx,\n    height: dy,\n    index: i,\n    payload: node\n  });\n\n  return nodeProps;\n};\n\nfunction NodeElement(_ref7) {\n  var {\n    props,\n    nodeContent,\n    i,\n    onMouseEnter: _onMouseEnter2,\n    onMouseLeave: _onMouseLeave2,\n    onClick: _onClick2,\n    dataKey\n  } = _ref7;\n  var dispatch = useAppDispatch();\n  var activeCoordinate = getCoordinateOfTooltip(props, 'node');\n  var activeIndex = \"node-\".concat(i);\n  var events = {\n    onMouseEnter: e => {\n      dispatch(setActiveMouseOverItemIndex({\n        activeIndex,\n        activeDataKey: dataKey,\n        activeCoordinate\n      }));\n\n      _onMouseEnter2(props, e);\n    },\n    onMouseLeave: e => {\n      dispatch(mouseLeaveItem());\n\n      _onMouseLeave2(props, e);\n    },\n    onClick: e => {\n      dispatch(setActiveClickItemIndex({\n        activeIndex,\n        activeDataKey: dataKey,\n        activeCoordinate\n      }));\n\n      _onClick2(props, e);\n    }\n  };\n  return /*#__PURE__*/React.createElement(Layer, events, renderNodeItem(nodeContent, props));\n}\n\nfunction AllNodeElements(_ref8) {\n  var {\n    modifiedNodes,\n    nodeContent,\n    onMouseEnter,\n    onMouseLeave,\n    onClick,\n    dataKey\n  } = _ref8;\n  return /*#__PURE__*/React.createElement(Layer, {\n    className: \"recharts-sankey-nodes\",\n    key: \"recharts-sankey-nodes\"\n  }, modifiedNodes.map((modifiedNode, i) => {\n    return /*#__PURE__*/React.createElement(NodeElement, {\n      props: modifiedNode,\n      nodeContent: nodeContent,\n      i: i,\n      onMouseEnter: onMouseEnter,\n      onMouseLeave: onMouseLeave,\n      onClick: onClick,\n      dataKey: dataKey\n    });\n  }));\n}\n\nexport class Sankey extends PureComponent {\n  constructor() {\n    super(...arguments);\n\n    _defineProperty(this, \"state\", {\n      nodes: [],\n      links: [],\n      modifiedLinks: [],\n      modifiedNodes: []\n    });\n  }\n\n  static getDerivedStateFromProps(nextProps, prevState) {\n    var {\n      data,\n      width,\n      height,\n      margin,\n      iterations,\n      nodeWidth,\n      nodePadding,\n      sort,\n      linkCurvature\n    } = nextProps;\n\n    if (data !== prevState.prevData || width !== prevState.prevWidth || height !== prevState.prevHeight || !shallowEqual(margin, prevState.prevMargin) || iterations !== prevState.prevIterations || nodeWidth !== prevState.prevNodeWidth || nodePadding !== prevState.prevNodePadding || sort !== prevState.sort) {\n      var contentWidth = width - (margin && margin.left || 0) - (margin && margin.right || 0);\n      var contentHeight = height - (margin && margin.top || 0) - (margin && margin.bottom || 0);\n      var {\n        links,\n        nodes\n      } = computeData({\n        data,\n        width: contentWidth,\n        height: contentHeight,\n        iterations,\n        nodeWidth,\n        nodePadding,\n        sort\n      });\n      var top = get(margin, 'top') || 0;\n      var left = get(margin, 'left') || 0;\n      var modifiedLinks = links.map((link, i) => {\n        return buildLinkProps({\n          link,\n          nodes,\n          i,\n          top,\n          left,\n          linkContent: nextProps.link,\n          linkCurvature\n        });\n      });\n      var modifiedNodes = nodes.map((node, i) => {\n        return buildNodeProps({\n          node,\n          nodeContent: nextProps.node,\n          i,\n          top,\n          left\n        });\n      });\n      return _objectSpread(_objectSpread({}, prevState), {}, {\n        nodes,\n        links,\n        modifiedLinks,\n        modifiedNodes,\n        prevData: data,\n        prevWidth: iterations,\n        prevHeight: height,\n        prevMargin: margin,\n        prevNodePadding: nodePadding,\n        prevNodeWidth: nodeWidth,\n        prevIterations: iterations,\n        prevSort: sort\n      });\n    }\n\n    return null;\n  }\n\n  handleMouseEnter(item, type, e) {\n    var {\n      onMouseEnter\n    } = this.props;\n\n    if (onMouseEnter) {\n      onMouseEnter(item, type, e);\n    }\n  }\n\n  handleMouseLeave(item, type, e) {\n    var {\n      onMouseLeave\n    } = this.props;\n\n    if (onMouseLeave) {\n      onMouseLeave(item, type, e);\n    }\n  }\n\n  handleClick(item, type, e) {\n    var {\n      onClick\n    } = this.props;\n    if (onClick) onClick(item, type, e);\n  }\n\n  render() {\n    var _this$props = this.props,\n        {\n      width,\n      height,\n      className,\n      style,\n      children\n    } = _this$props,\n        others = _objectWithoutProperties(_this$props, _excluded2);\n\n    if (!isPositiveNumber(width) || !isPositiveNumber(height)) {\n      return null;\n    }\n\n    var {\n      links,\n      modifiedNodes,\n      modifiedLinks\n    } = this.state;\n    var attrs = filterProps(others, false);\n    return /*#__PURE__*/React.createElement(RechartsStoreProvider, {\n      preloadedState: {\n        options\n      },\n      reduxStoreName: className !== null && className !== void 0 ? className : 'Sankey'\n    }, /*#__PURE__*/React.createElement(SetTooltipEntrySettings, {\n      fn: getTooltipEntrySettings,\n      args: this.props\n    }), /*#__PURE__*/React.createElement(SetComputedData, {\n      computedData: {\n        links: modifiedLinks,\n        nodes: modifiedNodes\n      }\n    }), /*#__PURE__*/React.createElement(ReportChartSize, {\n      width: width,\n      height: height\n    }), /*#__PURE__*/React.createElement(ReportChartMargin, {\n      margin: defaultSankeyMargin\n    }), /*#__PURE__*/React.createElement(TooltipPortalContext.Provider, {\n      value: this.state.tooltipPortal\n    }, /*#__PURE__*/React.createElement(RechartsWrapper, {\n      className: className,\n      style: style,\n      width: width,\n      height: height,\n      ref: node => {\n        if (this.state.tooltipPortal == null) {\n          this.setState({\n            tooltipPortal: node\n          });\n        }\n      },\n      onMouseEnter: undefined,\n      onMouseLeave: undefined,\n      onClick: undefined,\n      onMouseMove: undefined,\n      onMouseDown: undefined,\n      onMouseUp: undefined,\n      onContextMenu: undefined,\n      onDoubleClick: undefined,\n      onTouchStart: undefined,\n      onTouchMove: undefined,\n      onTouchEnd: undefined\n    }, /*#__PURE__*/React.createElement(Surface, _extends({}, attrs, {\n      width: width,\n      height: height\n    }), children, /*#__PURE__*/React.createElement(AllSankeyLinkElements, {\n      links: links,\n      modifiedLinks: modifiedLinks,\n      linkContent: this.props.link,\n      dataKey: this.props.dataKey,\n      onMouseEnter: (linkProps, e) => this.handleMouseEnter(linkProps, 'link', e),\n      onMouseLeave: (linkProps, e) => this.handleMouseLeave(linkProps, 'link', e),\n      onClick: (linkProps, e) => this.handleClick(linkProps, 'link', e)\n    }), /*#__PURE__*/React.createElement(AllNodeElements, {\n      modifiedNodes: modifiedNodes,\n      nodeContent: this.props.node,\n      dataKey: this.props.dataKey,\n      onMouseEnter: (nodeProps, e) => this.handleMouseEnter(nodeProps, 'node', e),\n      onMouseLeave: (nodeProps, e) => this.handleMouseLeave(nodeProps, 'node', e),\n      onClick: (nodeProps, e) => this.handleClick(nodeProps, 'node', e)\n    })))));\n  }\n\n}\n\n_defineProperty(Sankey, \"displayName\", 'Sankey');\n\n_defineProperty(Sankey, \"defaultProps\", {\n  nameKey: 'name',\n  dataKey: 'value',\n  nodePadding: 10,\n  nodeWidth: 10,\n  linkCurvature: 0.5,\n  iterations: 32,\n  margin: {\n    top: 5,\n    right: 5,\n    bottom: 5,\n    left: 5\n  },\n  sort: true\n});","map":{"version":3,"sources":["/Users/emiliamamedova/charts/project_corona_tracker/node_modules/recharts/es6/chart/Sankey.js"],"names":["_excluded","_excluded2","_extends","Object","assign","bind","n","e","arguments","length","t","r","hasOwnProperty","call","apply","_objectWithoutProperties","o","i","_objectWithoutPropertiesLoose","getOwnPropertySymbols","indexOf","propertyIsEnumerable","ownKeys","keys","filter","getOwnPropertyDescriptor","enumerable","push","_objectSpread","forEach","_defineProperty","getOwnPropertyDescriptors","defineProperties","defineProperty","_toPropertyKey","value","configurable","writable","_toPrimitive","Symbol","toPrimitive","TypeError","String","Number","React","PureComponent","maxBy","sumBy","get","Surface","Layer","Rectangle","shallowEqual","filterProps","getValueByDataKey","ReportChartMargin","ReportChartSize","TooltipPortalContext","RechartsWrapper","RechartsStoreProvider","useAppDispatch","mouseLeaveItem","setActiveClickItemIndex","setActiveMouseOverItemIndex","SetTooltipEntrySettings","SetComputedData","isPositiveNumber","interpolationGenerator","a","b","ka","kb","centerY","node","y","dy","getValue","entry","getSumOfIds","links","ids","reduce","result","id","getSumWithWeightedSource","tree","link","sourceNode","source","getSumWithWeightedTarget","targetNode","target","ascendingY","searchTargetsAndSources","sourceNodes","sourceLinks","targetNodes","targetLinks","len","updateDepthOfTargets","curNode","depth","Math","max","getNodesTree","_ref","width","nodeWidth","nodes","map","index","maxDepth","childWidth","_i","_len","_node","x","dx","getDepthTree","updateYOfTree","depthTree","height","nodePadding","yRatio","min","d","resolveCollisions","sort","undefined","y0","j","_j","_node2","_dy","relaxLeftToRight","alpha","sourceSum","weightedSum","relaxRightToLeft","targetSum","updateYOfLinks","sy","ty","tLen","_j2","sLen","_link","computeData","_ref2","data","iterations","newLinks","getCoordinateOfTooltip","item","type","sourceX","targetX","sourceY","targetY","getPayloadOfTooltip","nameKey","payload","name","sourceName","targetName","concat","sankeyPayloadSearcher","_","activeIndex","computedData","splitIndex","split","targetType","options","chartName","defaultTooltipEventType","validateTooltipEventTypes","tooltipPayloadSearcher","eventEmitter","getTooltipEntrySettings","props","dataKey","stroke","strokeWidth","fill","dataDefinedOnItem","positions","settings","color","unit","defaultSankeyMargin","top","right","bottom","left","renderLinkItem","option","isValidElement","cloneElement","sourceControlX","targetControlX","linkWidth","others","createElement","className","strokeOpacity","buildLinkProps","_ref3","linkContent","linkCurvature","sourceRelativeY","targetRelativeY","interpolationFunc","linkProps","SankeyLinkElement","_ref4","onMouseEnter","_onMouseEnter","onMouseLeave","_onMouseLeave","onClick","_onClick","activeCoordinate","dispatch","events","activeDataKey","AllSankeyLinkElements","_ref5","modifiedLinks","key","renderNodeItem","fillOpacity","buildNodeProps","_ref6","nodeContent","nodeProps","NodeElement","_ref7","_onMouseEnter2","_onMouseLeave2","_onClick2","AllNodeElements","_ref8","modifiedNodes","modifiedNode","Sankey","constructor","getDerivedStateFromProps","nextProps","prevState","margin","prevData","prevWidth","prevHeight","prevMargin","prevIterations","prevNodeWidth","prevNodePadding","contentWidth","contentHeight","prevSort","handleMouseEnter","handleMouseLeave","handleClick","render","_this$props","style","children","state","attrs","preloadedState","reduxStoreName","fn","args","Provider","tooltipPortal","ref","setState","onMouseMove","onMouseDown","onMouseUp","onContextMenu","onDoubleClick","onTouchStart","onTouchMove","onTouchEnd"],"mappings":"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","sourcesContent":["var _excluded = [\"sourceX\", \"sourceY\", \"sourceControlX\", \"targetX\", \"targetY\", \"targetControlX\", \"linkWidth\"],\n  _excluded2 = [\"width\", \"height\", \"className\", \"style\", \"children\"];\nfunction _extends() { return _extends = Object.assign ? Object.assign.bind() : function (n) { for (var e = 1; e < arguments.length; e++) { var t = arguments[e]; for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]); } return n; }, _extends.apply(null, arguments); }\nfunction _objectWithoutProperties(e, t) { if (null == e) return {}; var o, r, i = _objectWithoutPropertiesLoose(e, t); if (Object.getOwnPropertySymbols) { var n = Object.getOwnPropertySymbols(e); for (r = 0; r < n.length; r++) o = n[r], -1 === t.indexOf(o) && {}.propertyIsEnumerable.call(e, o) && (i[o] = e[o]); } return i; }\nfunction _objectWithoutPropertiesLoose(r, e) { if (null == r) return {}; var t = {}; for (var n in r) if ({}.hasOwnProperty.call(r, n)) { if (-1 !== e.indexOf(n)) continue; t[n] = r[n]; } return t; }\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nfunction _defineProperty(e, r, t) { return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, { value: t, enumerable: !0, configurable: !0, writable: !0 }) : e[r] = t, e; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == typeof i ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != typeof t || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != typeof i) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nimport * as React from 'react';\nimport { PureComponent } from 'react';\nimport maxBy from 'es-toolkit/compat/maxBy';\nimport sumBy from 'es-toolkit/compat/sumBy';\nimport get from 'es-toolkit/compat/get';\nimport { Surface } from '../container/Surface';\nimport { Layer } from '../container/Layer';\nimport { Rectangle } from '../shape/Rectangle';\nimport { shallowEqual } from '../util/ShallowEqual';\nimport { filterProps } from '../util/ReactUtils';\nimport { getValueByDataKey } from '../util/ChartUtils';\nimport { ReportChartMargin, ReportChartSize } from '../context/chartLayoutContext';\nimport { TooltipPortalContext } from '../context/tooltipPortalContext';\nimport { RechartsWrapper } from './RechartsWrapper';\nimport { RechartsStoreProvider } from '../state/RechartsStoreProvider';\nimport { useAppDispatch } from '../state/hooks';\nimport { mouseLeaveItem, setActiveClickItemIndex, setActiveMouseOverItemIndex } from '../state/tooltipSlice';\nimport { SetTooltipEntrySettings } from '../state/SetTooltipEntrySettings';\nimport { SetComputedData } from '../context/chartDataContext';\nimport { isPositiveNumber } from '../util/isWellBehavedNumber';\nvar interpolationGenerator = (a, b) => {\n  var ka = +a;\n  var kb = b - ka;\n  return t => ka + kb * t;\n};\nvar centerY = node => node.y + node.dy / 2;\nvar getValue = entry => entry && entry.value || 0;\nvar getSumOfIds = (links, ids) => ids.reduce((result, id) => result + getValue(links[id]), 0);\nvar getSumWithWeightedSource = (tree, links, ids) => ids.reduce((result, id) => {\n  var link = links[id];\n  var sourceNode = tree[link.source];\n  return result + centerY(sourceNode) * getValue(links[id]);\n}, 0);\nvar getSumWithWeightedTarget = (tree, links, ids) => ids.reduce((result, id) => {\n  var link = links[id];\n  var targetNode = tree[link.target];\n  return result + centerY(targetNode) * getValue(links[id]);\n}, 0);\nvar ascendingY = (a, b) => a.y - b.y;\nvar searchTargetsAndSources = (links, id) => {\n  var sourceNodes = [];\n  var sourceLinks = [];\n  var targetNodes = [];\n  var targetLinks = [];\n  for (var i = 0, len = links.length; i < len; i++) {\n    var link = links[i];\n    if (link.source === id) {\n      targetNodes.push(link.target);\n      targetLinks.push(i);\n    }\n    if (link.target === id) {\n      sourceNodes.push(link.source);\n      sourceLinks.push(i);\n    }\n  }\n  return {\n    sourceNodes,\n    sourceLinks,\n    targetLinks,\n    targetNodes\n  };\n};\nvar updateDepthOfTargets = (tree, curNode) => {\n  var {\n    targetNodes\n  } = curNode;\n  for (var i = 0, len = targetNodes.length; i < len; i++) {\n    var target = tree[targetNodes[i]];\n    if (target) {\n      target.depth = Math.max(curNode.depth + 1, target.depth);\n      updateDepthOfTargets(tree, target);\n    }\n  }\n};\nvar getNodesTree = (_ref, width, nodeWidth) => {\n  var {\n    nodes,\n    links\n  } = _ref;\n  var tree = nodes.map((entry, index) => {\n    var result = searchTargetsAndSources(links, index);\n    return _objectSpread(_objectSpread(_objectSpread({}, entry), result), {}, {\n      value: Math.max(getSumOfIds(links, result.sourceLinks), getSumOfIds(links, result.targetLinks)),\n      depth: 0\n    });\n  });\n  for (var i = 0, len = tree.length; i < len; i++) {\n    var node = tree[i];\n    if (!node.sourceNodes.length) {\n      updateDepthOfTargets(tree, node);\n    }\n  }\n  var maxDepth = maxBy(tree, entry => entry.depth).depth;\n  if (maxDepth >= 1) {\n    var childWidth = (width - nodeWidth) / maxDepth;\n    for (var _i = 0, _len = tree.length; _i < _len; _i++) {\n      var _node = tree[_i];\n      if (!_node.targetNodes.length) {\n        _node.depth = maxDepth;\n      }\n      _node.x = _node.depth * childWidth;\n      _node.dx = nodeWidth;\n    }\n  }\n  return {\n    tree,\n    maxDepth\n  };\n};\nvar getDepthTree = tree => {\n  var result = [];\n  for (var i = 0, len = tree.length; i < len; i++) {\n    var node = tree[i];\n    if (!result[node.depth]) {\n      result[node.depth] = [];\n    }\n    result[node.depth].push(node);\n  }\n  return result;\n};\nvar updateYOfTree = (depthTree, height, nodePadding, links) => {\n  var yRatio = Math.min(...depthTree.map(nodes => (height - (nodes.length - 1) * nodePadding) / sumBy(nodes, getValue)));\n  for (var d = 0, maxDepth = depthTree.length; d < maxDepth; d++) {\n    for (var i = 0, len = depthTree[d].length; i < len; i++) {\n      var node = depthTree[d][i];\n      node.y = i;\n      node.dy = node.value * yRatio;\n    }\n  }\n  return links.map(link => _objectSpread(_objectSpread({}, link), {}, {\n    dy: getValue(link) * yRatio\n  }));\n};\nvar resolveCollisions = function resolveCollisions(depthTree, height, nodePadding) {\n  var sort = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : true;\n  for (var i = 0, len = depthTree.length; i < len; i++) {\n    var nodes = depthTree[i];\n    var n = nodes.length;\n\n    // Sort by the value of y\n    if (sort) {\n      nodes.sort(ascendingY);\n    }\n    var y0 = 0;\n    for (var j = 0; j < n; j++) {\n      var node = nodes[j];\n      var dy = y0 - node.y;\n      if (dy > 0) {\n        node.y += dy;\n      }\n      y0 = node.y + node.dy + nodePadding;\n    }\n    y0 = height + nodePadding;\n    for (var _j = n - 1; _j >= 0; _j--) {\n      var _node2 = nodes[_j];\n      var _dy = _node2.y + _node2.dy + nodePadding - y0;\n      if (_dy > 0) {\n        _node2.y -= _dy;\n        y0 = _node2.y;\n      } else {\n        break;\n      }\n    }\n  }\n};\nvar relaxLeftToRight = (tree, depthTree, links, alpha) => {\n  for (var i = 0, maxDepth = depthTree.length; i < maxDepth; i++) {\n    var nodes = depthTree[i];\n    for (var j = 0, len = nodes.length; j < len; j++) {\n      var node = nodes[j];\n      if (node.sourceLinks.length) {\n        var sourceSum = getSumOfIds(links, node.sourceLinks);\n        var weightedSum = getSumWithWeightedSource(tree, links, node.sourceLinks);\n        var y = weightedSum / sourceSum;\n        node.y += (y - centerY(node)) * alpha;\n      }\n    }\n  }\n};\nvar relaxRightToLeft = (tree, depthTree, links, alpha) => {\n  for (var i = depthTree.length - 1; i >= 0; i--) {\n    var nodes = depthTree[i];\n    for (var j = 0, len = nodes.length; j < len; j++) {\n      var node = nodes[j];\n      if (node.targetLinks.length) {\n        var targetSum = getSumOfIds(links, node.targetLinks);\n        var weightedSum = getSumWithWeightedTarget(tree, links, node.targetLinks);\n        var y = weightedSum / targetSum;\n        node.y += (y - centerY(node)) * alpha;\n      }\n    }\n  }\n};\nvar updateYOfLinks = (tree, links) => {\n  for (var i = 0, len = tree.length; i < len; i++) {\n    var node = tree[i];\n    var sy = 0;\n    var ty = 0;\n    node.targetLinks.sort((a, b) => tree[links[a].target].y - tree[links[b].target].y);\n    node.sourceLinks.sort((a, b) => tree[links[a].source].y - tree[links[b].source].y);\n    for (var j = 0, tLen = node.targetLinks.length; j < tLen; j++) {\n      var link = links[node.targetLinks[j]];\n      if (link) {\n        link.sy = sy;\n        sy += link.dy;\n      }\n    }\n    for (var _j2 = 0, sLen = node.sourceLinks.length; _j2 < sLen; _j2++) {\n      var _link = links[node.sourceLinks[_j2]];\n      if (_link) {\n        _link.ty = ty;\n        ty += _link.dy;\n      }\n    }\n  }\n};\nvar computeData = _ref2 => {\n  var {\n    data,\n    width,\n    height,\n    iterations,\n    nodeWidth,\n    nodePadding,\n    sort\n  } = _ref2;\n  var {\n    links\n  } = data;\n  var {\n    tree\n  } = getNodesTree(data, width, nodeWidth);\n  var depthTree = getDepthTree(tree);\n  var newLinks = updateYOfTree(depthTree, height, nodePadding, links);\n  resolveCollisions(depthTree, height, nodePadding, sort);\n  var alpha = 1;\n  for (var i = 1; i <= iterations; i++) {\n    relaxRightToLeft(tree, depthTree, newLinks, alpha *= 0.99);\n    resolveCollisions(depthTree, height, nodePadding, sort);\n    relaxLeftToRight(tree, depthTree, newLinks, alpha);\n    resolveCollisions(depthTree, height, nodePadding, sort);\n  }\n  updateYOfLinks(tree, newLinks);\n  return {\n    nodes: tree,\n    links: newLinks\n  };\n};\nvar getCoordinateOfTooltip = (item, type) => {\n  if (type === 'node') {\n    return {\n      x: +item.x + +item.width / 2,\n      y: +item.y + +item.height / 2\n    };\n  }\n  return 'sourceX' in item && {\n    x: (item.sourceX + item.targetX) / 2,\n    y: (item.sourceY + item.targetY) / 2\n  };\n};\nvar getPayloadOfTooltip = (item, type, nameKey) => {\n  var {\n    payload\n  } = item;\n  if (type === 'node') {\n    return {\n      payload,\n      name: getValueByDataKey(payload, nameKey, ''),\n      value: getValueByDataKey(payload, 'value')\n    };\n  }\n  if ('source' in payload && payload.source && payload.target) {\n    var sourceName = getValueByDataKey(payload.source, nameKey, '');\n    var targetName = getValueByDataKey(payload.target, nameKey, '');\n    return {\n      payload,\n      name: \"\".concat(sourceName, \" - \").concat(targetName),\n      value: getValueByDataKey(payload, 'value')\n    };\n  }\n  return null;\n};\nexport var sankeyPayloadSearcher = (_, activeIndex, computedData, nameKey) => {\n  if (activeIndex == null || typeof activeIndex !== 'string') {\n    return undefined;\n  }\n  var splitIndex = activeIndex.split('-');\n  var [targetType, index] = splitIndex;\n  var item = get(computedData, \"\".concat(targetType, \"s[\").concat(index, \"]\"));\n  if (item) {\n    var payload = getPayloadOfTooltip(item, targetType, nameKey);\n    return payload;\n  }\n  return undefined;\n};\nvar options = {\n  chartName: 'Sankey',\n  defaultTooltipEventType: 'item',\n  validateTooltipEventTypes: ['item'],\n  tooltipPayloadSearcher: sankeyPayloadSearcher,\n  eventEmitter: undefined\n};\nfunction getTooltipEntrySettings(props) {\n  var {\n    dataKey,\n    nameKey,\n    stroke,\n    strokeWidth,\n    fill,\n    name,\n    data\n  } = props;\n  return {\n    dataDefinedOnItem: data,\n    positions: undefined,\n    settings: {\n      stroke,\n      strokeWidth,\n      fill,\n      dataKey,\n      name,\n      nameKey,\n      color: fill,\n      unit: '' // Sankey does not have unit, why?\n    }\n  };\n}\n\n// TODO: improve types - NodeOptions uses SankeyNode, LinkOptions uses LinkProps. Standardize.\n\n// Why is margin not a Sankey prop? No clue. Probably it should be\nvar defaultSankeyMargin = {\n  top: 0,\n  right: 0,\n  bottom: 0,\n  left: 0\n};\nfunction renderLinkItem(option, props) {\n  if (/*#__PURE__*/React.isValidElement(option)) {\n    return /*#__PURE__*/React.cloneElement(option, props);\n  }\n  if (typeof option === 'function') {\n    return option(props);\n  }\n  var {\n      sourceX,\n      sourceY,\n      sourceControlX,\n      targetX,\n      targetY,\n      targetControlX,\n      linkWidth\n    } = props,\n    others = _objectWithoutProperties(props, _excluded);\n  return /*#__PURE__*/React.createElement(\"path\", _extends({\n    className: \"recharts-sankey-link\",\n    d: \"\\n          M\".concat(sourceX, \",\").concat(sourceY, \"\\n          C\").concat(sourceControlX, \",\").concat(sourceY, \" \").concat(targetControlX, \",\").concat(targetY, \" \").concat(targetX, \",\").concat(targetY, \"\\n        \"),\n    fill: \"none\",\n    stroke: \"#333\",\n    strokeWidth: linkWidth,\n    strokeOpacity: \"0.2\"\n  }, filterProps(others, false)));\n}\nvar buildLinkProps = _ref3 => {\n  var {\n    link,\n    nodes,\n    left,\n    top,\n    i,\n    linkContent,\n    linkCurvature\n  } = _ref3;\n  var {\n    sy: sourceRelativeY,\n    ty: targetRelativeY,\n    dy: linkWidth\n  } = link;\n  var sourceNode = nodes[link.source];\n  var targetNode = nodes[link.target];\n  var sourceX = sourceNode.x + sourceNode.dx + left;\n  var targetX = targetNode.x + left;\n  var interpolationFunc = interpolationGenerator(sourceX, targetX);\n  var sourceControlX = interpolationFunc(linkCurvature);\n  var targetControlX = interpolationFunc(1 - linkCurvature);\n  var sourceY = sourceNode.y + sourceRelativeY + linkWidth / 2 + top;\n  var targetY = targetNode.y + targetRelativeY + linkWidth / 2 + top;\n  var linkProps = _objectSpread({\n    sourceX,\n    targetX,\n    sourceY,\n    targetY,\n    sourceControlX,\n    targetControlX,\n    sourceRelativeY,\n    targetRelativeY,\n    linkWidth,\n    index: i,\n    payload: _objectSpread(_objectSpread({}, link), {}, {\n      source: sourceNode,\n      target: targetNode\n    })\n  }, filterProps(linkContent, false));\n  return linkProps;\n};\nfunction SankeyLinkElement(_ref4) {\n  var {\n    props,\n    i,\n    linkContent,\n    onMouseEnter: _onMouseEnter,\n    onMouseLeave: _onMouseLeave,\n    onClick: _onClick,\n    dataKey\n  } = _ref4;\n  var activeCoordinate = getCoordinateOfTooltip(props, 'link');\n  var activeIndex = \"link-\".concat(i);\n  var dispatch = useAppDispatch();\n  var events = {\n    onMouseEnter: e => {\n      dispatch(setActiveMouseOverItemIndex({\n        activeIndex,\n        activeDataKey: dataKey,\n        activeCoordinate\n      }));\n      _onMouseEnter(props, e);\n    },\n    onMouseLeave: e => {\n      dispatch(mouseLeaveItem());\n      _onMouseLeave(props, e);\n    },\n    onClick: e => {\n      dispatch(setActiveClickItemIndex({\n        activeIndex,\n        activeDataKey: dataKey,\n        activeCoordinate\n      }));\n      _onClick(props, e);\n    }\n  };\n  return /*#__PURE__*/React.createElement(Layer, events, renderLinkItem(linkContent, props));\n}\nfunction AllSankeyLinkElements(_ref5) {\n  var {\n    modifiedLinks,\n    links,\n    linkContent,\n    onMouseEnter,\n    onMouseLeave,\n    onClick,\n    dataKey\n  } = _ref5;\n  return /*#__PURE__*/React.createElement(Layer, {\n    className: \"recharts-sankey-links\",\n    key: \"recharts-sankey-links\"\n  }, links.map((link, i) => {\n    var linkProps = modifiedLinks[i];\n    return /*#__PURE__*/React.createElement(SankeyLinkElement, {\n      key: \"link-\".concat(link.source, \"-\").concat(link.target, \"-\").concat(link.value),\n      props: linkProps,\n      linkContent: linkContent,\n      i: i,\n      onMouseEnter: onMouseEnter,\n      onMouseLeave: onMouseLeave,\n      onClick: onClick,\n      dataKey: dataKey\n    });\n  }));\n}\nfunction renderNodeItem(option, props) {\n  if (/*#__PURE__*/React.isValidElement(option)) {\n    return /*#__PURE__*/React.cloneElement(option, props);\n  }\n  if (typeof option === 'function') {\n    return option(props);\n  }\n  return /*#__PURE__*/React.createElement(Rectangle, _extends({\n    className: \"recharts-sankey-node\",\n    fill: \"#0088fe\",\n    fillOpacity: \"0.8\"\n  }, filterProps(props, false)));\n}\nvar buildNodeProps = _ref6 => {\n  var {\n    node,\n    nodeContent,\n    top,\n    left,\n    i\n  } = _ref6;\n  var {\n    x,\n    y,\n    dx,\n    dy\n  } = node;\n  var nodeProps = _objectSpread(_objectSpread({}, filterProps(nodeContent, false)), {}, {\n    x: x + left,\n    y: y + top,\n    width: dx,\n    height: dy,\n    index: i,\n    payload: node\n  });\n  return nodeProps;\n};\nfunction NodeElement(_ref7) {\n  var {\n    props,\n    nodeContent,\n    i,\n    onMouseEnter: _onMouseEnter2,\n    onMouseLeave: _onMouseLeave2,\n    onClick: _onClick2,\n    dataKey\n  } = _ref7;\n  var dispatch = useAppDispatch();\n  var activeCoordinate = getCoordinateOfTooltip(props, 'node');\n  var activeIndex = \"node-\".concat(i);\n  var events = {\n    onMouseEnter: e => {\n      dispatch(setActiveMouseOverItemIndex({\n        activeIndex,\n        activeDataKey: dataKey,\n        activeCoordinate\n      }));\n      _onMouseEnter2(props, e);\n    },\n    onMouseLeave: e => {\n      dispatch(mouseLeaveItem());\n      _onMouseLeave2(props, e);\n    },\n    onClick: e => {\n      dispatch(setActiveClickItemIndex({\n        activeIndex,\n        activeDataKey: dataKey,\n        activeCoordinate\n      }));\n      _onClick2(props, e);\n    }\n  };\n  return /*#__PURE__*/React.createElement(Layer, events, renderNodeItem(nodeContent, props));\n}\nfunction AllNodeElements(_ref8) {\n  var {\n    modifiedNodes,\n    nodeContent,\n    onMouseEnter,\n    onMouseLeave,\n    onClick,\n    dataKey\n  } = _ref8;\n  return /*#__PURE__*/React.createElement(Layer, {\n    className: \"recharts-sankey-nodes\",\n    key: \"recharts-sankey-nodes\"\n  }, modifiedNodes.map((modifiedNode, i) => {\n    return /*#__PURE__*/React.createElement(NodeElement, {\n      props: modifiedNode,\n      nodeContent: nodeContent,\n      i: i,\n      onMouseEnter: onMouseEnter,\n      onMouseLeave: onMouseLeave,\n      onClick: onClick,\n      dataKey: dataKey\n    });\n  }));\n}\nexport class Sankey extends PureComponent {\n  constructor() {\n    super(...arguments);\n    _defineProperty(this, \"state\", {\n      nodes: [],\n      links: [],\n      modifiedLinks: [],\n      modifiedNodes: []\n    });\n  }\n  static getDerivedStateFromProps(nextProps, prevState) {\n    var {\n      data,\n      width,\n      height,\n      margin,\n      iterations,\n      nodeWidth,\n      nodePadding,\n      sort,\n      linkCurvature\n    } = nextProps;\n    if (data !== prevState.prevData || width !== prevState.prevWidth || height !== prevState.prevHeight || !shallowEqual(margin, prevState.prevMargin) || iterations !== prevState.prevIterations || nodeWidth !== prevState.prevNodeWidth || nodePadding !== prevState.prevNodePadding || sort !== prevState.sort) {\n      var contentWidth = width - (margin && margin.left || 0) - (margin && margin.right || 0);\n      var contentHeight = height - (margin && margin.top || 0) - (margin && margin.bottom || 0);\n      var {\n        links,\n        nodes\n      } = computeData({\n        data,\n        width: contentWidth,\n        height: contentHeight,\n        iterations,\n        nodeWidth,\n        nodePadding,\n        sort\n      });\n      var top = get(margin, 'top') || 0;\n      var left = get(margin, 'left') || 0;\n      var modifiedLinks = links.map((link, i) => {\n        return buildLinkProps({\n          link,\n          nodes,\n          i,\n          top,\n          left,\n          linkContent: nextProps.link,\n          linkCurvature\n        });\n      });\n      var modifiedNodes = nodes.map((node, i) => {\n        return buildNodeProps({\n          node,\n          nodeContent: nextProps.node,\n          i,\n          top,\n          left\n        });\n      });\n      return _objectSpread(_objectSpread({}, prevState), {}, {\n        nodes,\n        links,\n        modifiedLinks,\n        modifiedNodes,\n        prevData: data,\n        prevWidth: iterations,\n        prevHeight: height,\n        prevMargin: margin,\n        prevNodePadding: nodePadding,\n        prevNodeWidth: nodeWidth,\n        prevIterations: iterations,\n        prevSort: sort\n      });\n    }\n    return null;\n  }\n  handleMouseEnter(item, type, e) {\n    var {\n      onMouseEnter\n    } = this.props;\n    if (onMouseEnter) {\n      onMouseEnter(item, type, e);\n    }\n  }\n  handleMouseLeave(item, type, e) {\n    var {\n      onMouseLeave\n    } = this.props;\n    if (onMouseLeave) {\n      onMouseLeave(item, type, e);\n    }\n  }\n  handleClick(item, type, e) {\n    var {\n      onClick\n    } = this.props;\n    if (onClick) onClick(item, type, e);\n  }\n  render() {\n    var _this$props = this.props,\n      {\n        width,\n        height,\n        className,\n        style,\n        children\n      } = _this$props,\n      others = _objectWithoutProperties(_this$props, _excluded2);\n    if (!isPositiveNumber(width) || !isPositiveNumber(height)) {\n      return null;\n    }\n    var {\n      links,\n      modifiedNodes,\n      modifiedLinks\n    } = this.state;\n    var attrs = filterProps(others, false);\n    return /*#__PURE__*/React.createElement(RechartsStoreProvider, {\n      preloadedState: {\n        options\n      },\n      reduxStoreName: className !== null && className !== void 0 ? className : 'Sankey'\n    }, /*#__PURE__*/React.createElement(SetTooltipEntrySettings, {\n      fn: getTooltipEntrySettings,\n      args: this.props\n    }), /*#__PURE__*/React.createElement(SetComputedData, {\n      computedData: {\n        links: modifiedLinks,\n        nodes: modifiedNodes\n      }\n    }), /*#__PURE__*/React.createElement(ReportChartSize, {\n      width: width,\n      height: height\n    }), /*#__PURE__*/React.createElement(ReportChartMargin, {\n      margin: defaultSankeyMargin\n    }), /*#__PURE__*/React.createElement(TooltipPortalContext.Provider, {\n      value: this.state.tooltipPortal\n    }, /*#__PURE__*/React.createElement(RechartsWrapper, {\n      className: className,\n      style: style,\n      width: width,\n      height: height,\n      ref: node => {\n        if (this.state.tooltipPortal == null) {\n          this.setState({\n            tooltipPortal: node\n          });\n        }\n      },\n      onMouseEnter: undefined,\n      onMouseLeave: undefined,\n      onClick: undefined,\n      onMouseMove: undefined,\n      onMouseDown: undefined,\n      onMouseUp: undefined,\n      onContextMenu: undefined,\n      onDoubleClick: undefined,\n      onTouchStart: undefined,\n      onTouchMove: undefined,\n      onTouchEnd: undefined\n    }, /*#__PURE__*/React.createElement(Surface, _extends({}, attrs, {\n      width: width,\n      height: height\n    }), children, /*#__PURE__*/React.createElement(AllSankeyLinkElements, {\n      links: links,\n      modifiedLinks: modifiedLinks,\n      linkContent: this.props.link,\n      dataKey: this.props.dataKey,\n      onMouseEnter: (linkProps, e) => this.handleMouseEnter(linkProps, 'link', e),\n      onMouseLeave: (linkProps, e) => this.handleMouseLeave(linkProps, 'link', e),\n      onClick: (linkProps, e) => this.handleClick(linkProps, 'link', e)\n    }), /*#__PURE__*/React.createElement(AllNodeElements, {\n      modifiedNodes: modifiedNodes,\n      nodeContent: this.props.node,\n      dataKey: this.props.dataKey,\n      onMouseEnter: (nodeProps, e) => this.handleMouseEnter(nodeProps, 'node', e),\n      onMouseLeave: (nodeProps, e) => this.handleMouseLeave(nodeProps, 'node', e),\n      onClick: (nodeProps, e) => this.handleClick(nodeProps, 'node', e)\n    })))));\n  }\n}\n_defineProperty(Sankey, \"displayName\", 'Sankey');\n_defineProperty(Sankey, \"defaultProps\", {\n  nameKey: 'name',\n  dataKey: 'value',\n  nodePadding: 10,\n  nodeWidth: 10,\n  linkCurvature: 0.5,\n  iterations: 32,\n  margin: {\n    top: 5,\n    right: 5,\n    bottom: 5,\n    left: 5\n  },\n  sort: true\n});"]},"metadata":{},"sourceType":"module"}