{"ast":null,"code":"var _jsxFileName = \"/Users/emiliamamedova/charts/project_corona_tracker/src/components/Chart/Chart.jsx\";\nimport React, { useState, useEffect } from 'react';\nimport { Bar, Pie, Line } from 'react-chartjs-2';\n\nconst Analytics = () => {\n  const [activeTab, setActiveTab] = useState('top3');\n  const [top3Data, setTop3Data] = useState([]);\n  const [directionData, setDirectionData] = useState([]);\n  const [punctualityData, setPunctualityData] = useState([]);\n  useEffect(() => {\n    // Топ 3 авиакомпании\n    fetch('http://localhost:8000/get_top3').then(res => res.json()).then(data => setTop3Data(data)).catch(console.error); // Направления\n\n    fetch('http://localhost:8000/get_all_direction').then(res => res.json()).then(data => setDirectionData(data)).catch(console.error); // Пунктуальность авиакомпаний\n\n    fetch('http://localhost:8000/get_airline_punctuality').then(res => res.json()).then(data => setPunctualityData(data)).catch(console.error);\n  }, []); // 1. Топ 3 авиакомпании - Bar chart\n\n  const top3ChartData = {\n    labels: top3Data.map(a => a.airline_name),\n    datasets: [{\n      label: 'Пунктуальность вылета',\n      backgroundColor: 'rgba(75,192,192,0.6)',\n      data: top3Data.map(a => a.rating_departure)\n    }, {\n      label: 'Пунктуальность прилёта',\n      backgroundColor: 'rgba(153,102,255,0.6)',\n      data: top3Data.map(a => a.rating_arrival)\n    }]\n  }; // 2. Направления - Pie chart\n  // Ожидаем data в формате [{ direction: \"MOW-SPB\", count: 123 }, ...]\n\n  const directionsLabels = directionData.map(d => d.direction || d.name || '—');\n  const directionsCounts = directionData.map(d => d.count || d.flight_count || 0);\n  const directionsChartData = {\n    labels: directionsLabels,\n    datasets: [{\n      label: 'Количество рейсов',\n      data: directionsCounts,\n      backgroundColor: directionsLabels.map(() => `hsl(${Math.floor(Math.random() * 360)}, 70%, 70%)`)\n    }]\n  }; // 3. Пунктуальность - Line chart\n  // Пример: данные массива с датой и значениями для разных авиакомпаний\n  // Формат данных: [{date: \"2025-07-01\", airline: \"S7\", punctuality: 95}, ...]\n  // Для примера сгруппируем по авиакомпаниям и построим динамику\n  // Собираем уникальные даты\n\n  const dates = Array.from(new Set(punctualityData.map(d => d.date))).sort(); // Собираем уникальные авиакомпании\n\n  const airlines = Array.from(new Set(punctualityData.map(d => d.airline))); // Формируем datasets для каждой авиакомпании\n\n  const punctualityDatasets = airlines.map((airline, idx) => {\n    return {\n      label: airline,\n      data: dates.map(date => {\n        const record = punctualityData.find(d => d.airline === airline && d.date === date);\n        return record ? record.punctuality : null;\n      }),\n      borderColor: `hsl(${idx * 60 % 360}, 70%, 50%)`,\n      fill: false\n    };\n  });\n  const punctualityChartData = {\n    labels: dates,\n    datasets: punctualityDatasets\n  };\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      marginBottom: 20\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    onClick: () => setActiveTab('top3'),\n    disabled: activeTab === 'top3',\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 9\n    }\n  }, \"\\u0422\\u043E\\u043F 3 \\u0430\\u0432\\u0438\\u0430\\u043A\\u043E\\u043C\\u043F\\u0430\\u043D\\u0438\\u0438\"), /*#__PURE__*/React.createElement(\"button\", {\n    onClick: () => setActiveTab('directions'),\n    disabled: activeTab === 'directions',\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 9\n    }\n  }, \"\\u041D\\u0430\\u043F\\u0440\\u0430\\u0432\\u043B\\u0435\\u043D\\u0438\\u044F\"), /*#__PURE__*/React.createElement(\"button\", {\n    onClick: () => setActiveTab('punctuality'),\n    disabled: activeTab === 'punctuality',\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 9\n    }\n  }, \"\\u041F\\u0443\\u043D\\u043A\\u0442\\u0443\\u0430\\u043B\\u044C\\u043D\\u043E\\u0441\\u0442\\u044C\")), activeTab === 'top3' && /*#__PURE__*/React.createElement(Bar, {\n    data: top3ChartData,\n    options: {\n      responsive: true,\n      plugins: {\n        title: {\n          display: true,\n          text: 'Топ 3 авиакомпании по пунктуальности'\n        }\n      }\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 9\n    }\n  }), activeTab === 'directions' && /*#__PURE__*/React.createElement(Pie, {\n    data: directionsChartData,\n    options: {\n      responsive: true,\n      plugins: {\n        title: {\n          display: true,\n          text: 'Распределение рейсов по направлениям'\n        }\n      }\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 9\n    }\n  }), activeTab === 'punctuality' && /*#__PURE__*/React.createElement(Line, {\n    data: punctualityChartData,\n    options: {\n      responsive: true,\n      plugins: {\n        title: {\n          display: true,\n          text: 'Динамика пунктуальности авиакомпаний'\n        }\n      },\n      scales: {\n        y: {\n          min: 0,\n          max: 100,\n          title: {\n            display: true,\n            text: 'Пунктуальность (%)'\n          }\n        },\n        x: {\n          title: {\n            display: true,\n            text: 'Дата'\n          }\n        }\n      }\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 9\n    }\n  }));\n};\n\nexport default Analytics;","map":{"version":3,"sources":["/Users/emiliamamedova/charts/project_corona_tracker/src/components/Chart/Chart.jsx"],"names":["React","useState","useEffect","Bar","Pie","Line","Analytics","activeTab","setActiveTab","top3Data","setTop3Data","directionData","setDirectionData","punctualityData","setPunctualityData","fetch","then","res","json","data","catch","console","error","top3ChartData","labels","map","a","airline_name","datasets","label","backgroundColor","rating_departure","rating_arrival","directionsLabels","d","direction","name","directionsCounts","count","flight_count","directionsChartData","Math","floor","random","dates","Array","from","Set","date","sort","airlines","airline","punctualityDatasets","idx","record","find","punctuality","borderColor","fill","punctualityChartData","marginBottom","responsive","plugins","title","display","text","scales","y","min","max","x"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Bar, Pie, Line } from 'react-chartjs-2';\n\nconst Analytics = () => {\n  const [activeTab, setActiveTab] = useState('top3');\n  const [top3Data, setTop3Data] = useState([]);\n  const [directionData, setDirectionData] = useState([]);\n  const [punctualityData, setPunctualityData] = useState([]);\n\n  useEffect(() => {\n    // Топ 3 авиакомпании\n    fetch('http://localhost:8000/get_top3')\n      .then(res => res.json())\n      .then(data => setTop3Data(data))\n      .catch(console.error);\n\n    // Направления\n    fetch('http://localhost:8000/get_all_direction')\n      .then(res => res.json())\n      .then(data => setDirectionData(data))\n      .catch(console.error);\n\n    // Пунктуальность авиакомпаний\n    fetch('http://localhost:8000/get_airline_punctuality')\n      .then(res => res.json())\n      .then(data => setPunctualityData(data))\n      .catch(console.error);\n  }, []);\n\n  // 1. Топ 3 авиакомпании - Bar chart\n  const top3ChartData = {\n    labels: top3Data.map(a => a.airline_name),\n    datasets: [\n      {\n        label: 'Пунктуальность вылета',\n        backgroundColor: 'rgba(75,192,192,0.6)',\n        data: top3Data.map(a => a.rating_departure),\n      },\n      {\n        label: 'Пунктуальность прилёта',\n        backgroundColor: 'rgba(153,102,255,0.6)',\n        data: top3Data.map(a => a.rating_arrival),\n      },\n    ],\n  };\n\n  // 2. Направления - Pie chart\n  // Ожидаем data в формате [{ direction: \"MOW-SPB\", count: 123 }, ...]\n  const directionsLabels = directionData.map(d => d.direction || d.name || '—');\n  const directionsCounts = directionData.map(d => d.count || d.flight_count || 0);\n\n  const directionsChartData = {\n    labels: directionsLabels,\n    datasets: [\n      {\n        label: 'Количество рейсов',\n        data: directionsCounts,\n        backgroundColor: directionsLabels.map(() =>\n          `hsl(${Math.floor(Math.random() * 360)}, 70%, 70%)`\n        ),\n      },\n    ],\n  };\n\n  // 3. Пунктуальность - Line chart\n  // Пример: данные массива с датой и значениями для разных авиакомпаний\n  // Формат данных: [{date: \"2025-07-01\", airline: \"S7\", punctuality: 95}, ...]\n  // Для примера сгруппируем по авиакомпаниям и построим динамику\n\n  // Собираем уникальные даты\n  const dates = Array.from(new Set(punctualityData.map(d => d.date))).sort();\n\n  // Собираем уникальные авиакомпании\n  const airlines = Array.from(new Set(punctualityData.map(d => d.airline)));\n\n  // Формируем datasets для каждой авиакомпании\n  const punctualityDatasets = airlines.map((airline, idx) => {\n    return {\n      label: airline,\n      data: dates.map(date => {\n        const record = punctualityData.find(d => d.airline === airline && d.date === date);\n        return record ? record.punctuality : null;\n      }),\n      borderColor: `hsl(${(idx * 60) % 360}, 70%, 50%)`,\n      fill: false,\n    };\n  });\n\n  const punctualityChartData = {\n    labels: dates,\n    datasets: punctualityDatasets,\n  };\n\n  return (\n    <div>\n      <div style={{ marginBottom: 20 }}>\n        <button onClick={() => setActiveTab('top3')} disabled={activeTab === 'top3'}>\n          Топ 3 авиакомпании\n        </button>\n        <button onClick={() => setActiveTab('directions')} disabled={activeTab === 'directions'}>\n          Направления\n        </button>\n        <button onClick={() => setActiveTab('punctuality')} disabled={activeTab === 'punctuality'}>\n          Пунктуальность\n        </button>\n      </div>\n\n      {activeTab === 'top3' && (\n        <Bar\n          data={top3ChartData}\n          options={{\n            responsive: true,\n            plugins: {\n              title: { display: true, text: 'Топ 3 авиакомпании по пунктуальности' },\n            },\n          }}\n        />\n      )}\n\n      {activeTab === 'directions' && (\n        <Pie\n          data={directionsChartData}\n          options={{\n            responsive: true,\n            plugins: {\n              title: { display: true, text: 'Распределение рейсов по направлениям' },\n            },\n          }}\n        />\n      )}\n\n      {activeTab === 'punctuality' && (\n        <Line\n          data={punctualityChartData}\n          options={{\n            responsive: true,\n            plugins: {\n              title: { display: true, text: 'Динамика пунктуальности авиакомпаний' },\n            },\n            scales: {\n              y: { min: 0, max: 100, title: { display: true, text: 'Пунктуальность (%)' } },\n              x: { title: { display: true, text: 'Дата' } },\n            },\n          }}\n        />\n      )}\n    </div>\n  );\n};\n\nexport default Analytics;\n"]},"metadata":{},"sourceType":"module"}