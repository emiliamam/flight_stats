{"ast":null,"code":"function _extends() {\n  return _extends = Object.assign ? Object.assign.bind() : function (n) {\n    for (var e = 1; e < arguments.length; e++) {\n      var t = arguments[e];\n\n      for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]);\n    }\n\n    return n;\n  }, _extends.apply(null, arguments);\n}\n\nfunction ownKeys(e, r) {\n  var t = Object.keys(e);\n\n  if (Object.getOwnPropertySymbols) {\n    var o = Object.getOwnPropertySymbols(e);\n    r && (o = o.filter(function (r) {\n      return Object.getOwnPropertyDescriptor(e, r).enumerable;\n    })), t.push.apply(t, o);\n  }\n\n  return t;\n}\n\nfunction _objectSpread(e) {\n  for (var r = 1; r < arguments.length; r++) {\n    var t = null != arguments[r] ? arguments[r] : {};\n    r % 2 ? ownKeys(Object(t), !0).forEach(function (r) {\n      _defineProperty(e, r, t[r]);\n    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) {\n      Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r));\n    });\n  }\n\n  return e;\n}\n\nfunction _defineProperty(e, r, t) {\n  return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, {\n    value: t,\n    enumerable: !0,\n    configurable: !0,\n    writable: !0\n  }) : e[r] = t, e;\n}\n\nfunction _toPropertyKey(t) {\n  var i = _toPrimitive(t, \"string\");\n\n  return \"symbol\" == typeof i ? i : i + \"\";\n}\n\nfunction _toPrimitive(t, r) {\n  if (\"object\" != typeof t || !t) return t;\n  var e = t[Symbol.toPrimitive];\n\n  if (void 0 !== e) {\n    var i = e.call(t, r || \"default\");\n    if (\"object\" != typeof i) return i;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n\n  return (\"string\" === r ? String : Number)(t);\n}\n/*\n * After we refactor classes to functional components, we can remove this eslint-disable\n */\n\n/* eslint-disable max-classes-per-file */\n\n\nimport * as React from 'react';\nimport { Children, PureComponent, useCallback, useContext, useEffect } from 'react';\nimport { clsx } from 'clsx';\nimport { scalePoint } from 'victory-vendor/d3-scale';\nimport range from 'es-toolkit/compat/range';\nimport { Layer } from '../container/Layer';\nimport { Text } from '../component/Text';\nimport { getValueByDataKey } from '../util/ChartUtils';\nimport { isNumber } from '../util/DataUtils';\nimport { generatePrefixStyle } from '../util/CssPrefixUtils';\nimport { filterProps } from '../util/ReactUtils';\nimport { useChartData, useDataIndex } from '../context/chartDataContext';\nimport { BrushUpdateDispatchContext } from '../context/brushUpdateContext';\nimport { useAppDispatch, useAppSelector } from '../state/hooks';\nimport { setDataStartEndIndexes } from '../state/chartDataSlice';\nimport { setBrushSettings } from '../state/brushSlice';\nimport { PanoramaContextProvider } from '../context/PanoramaContext';\nimport { selectBrushDimensions } from '../state/selectors/brushSelectors';\nimport { useBrushChartSynchronisation } from '../synchronisation/useChartSynchronisation'; // Why is this tickFormatter different from the other TickFormatters? This one allows to return numbers too for some reason.\n\nfunction DefaultTraveller(props) {\n  var {\n    x,\n    y,\n    width,\n    height,\n    stroke\n  } = props;\n  var lineY = Math.floor(y + height / 2) - 1;\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"rect\", {\n    x: x,\n    y: y,\n    width: width,\n    height: height,\n    fill: stroke,\n    stroke: \"none\"\n  }), /*#__PURE__*/React.createElement(\"line\", {\n    x1: x + 1,\n    y1: lineY,\n    x2: x + width - 1,\n    y2: lineY,\n    fill: \"none\",\n    stroke: \"#fff\"\n  }), /*#__PURE__*/React.createElement(\"line\", {\n    x1: x + 1,\n    y1: lineY + 2,\n    x2: x + width - 1,\n    y2: lineY + 2,\n    fill: \"none\",\n    stroke: \"#fff\"\n  }));\n}\n\nfunction Traveller(props) {\n  var {\n    travellerProps,\n    travellerType\n  } = props;\n\n  if ( /*#__PURE__*/React.isValidElement(travellerType)) {\n    // @ts-expect-error element cloning disagrees with the types (and it should)\n    return /*#__PURE__*/React.cloneElement(travellerType, travellerProps);\n  }\n\n  if (typeof travellerType === 'function') {\n    return travellerType(travellerProps);\n  }\n\n  return /*#__PURE__*/React.createElement(DefaultTraveller, travellerProps);\n}\n\nfunction TravellerLayer(_ref) {\n  var _data$startIndex, _data$endIndex;\n\n  var {\n    otherProps,\n    travellerX,\n    id,\n    onMouseEnter,\n    onMouseLeave,\n    onMouseDown,\n    onTouchStart,\n    onTravellerMoveKeyboard,\n    onFocus,\n    onBlur\n  } = _ref;\n  var {\n    y,\n    x: xFromProps,\n    travellerWidth,\n    height,\n    traveller,\n    ariaLabel,\n    data,\n    startIndex,\n    endIndex\n  } = otherProps;\n  var x = Math.max(travellerX, xFromProps);\n\n  var travellerProps = _objectSpread(_objectSpread({}, filterProps(otherProps, false)), {}, {\n    x,\n    y,\n    width: travellerWidth,\n    height\n  });\n\n  var ariaLabelBrush = ariaLabel || \"Min value: \".concat((_data$startIndex = data[startIndex]) === null || _data$startIndex === void 0 ? void 0 : _data$startIndex.name, \", Max value: \").concat((_data$endIndex = data[endIndex]) === null || _data$endIndex === void 0 ? void 0 : _data$endIndex.name);\n  return /*#__PURE__*/React.createElement(Layer, {\n    tabIndex: 0,\n    role: \"slider\",\n    \"aria-label\": ariaLabelBrush,\n    \"aria-valuenow\": travellerX,\n    className: \"recharts-brush-traveller\",\n    onMouseEnter: onMouseEnter,\n    onMouseLeave: onMouseLeave,\n    onMouseDown: onMouseDown,\n    onTouchStart: onTouchStart,\n    onKeyDown: e => {\n      if (!['ArrowLeft', 'ArrowRight'].includes(e.key)) {\n        return;\n      }\n\n      e.preventDefault();\n      e.stopPropagation();\n      onTravellerMoveKeyboard(e.key === 'ArrowRight' ? 1 : -1, id);\n    },\n    onFocus: onFocus,\n    onBlur: onBlur,\n    style: {\n      cursor: 'col-resize'\n    }\n  }, /*#__PURE__*/React.createElement(Traveller, {\n    travellerType: traveller,\n    travellerProps: travellerProps\n  }));\n}\n/*\n * This one cannot be a React Component because React is not happy with it returning only string | number.\n * React wants a full React.JSX.Element but that is not compatible with Text component.\n */\n\n\nfunction getTextOfTick(props) {\n  var {\n    index,\n    data,\n    tickFormatter,\n    dataKey\n  } = props;\n  var text = getValueByDataKey(data[index], dataKey, index); // @ts-expect-error getValueByDataKey does not validate the output type\n\n  return typeof tickFormatter === 'function' ? tickFormatter(text, index) : text;\n}\n\nfunction getIndexInRange(valueRange, x) {\n  var len = valueRange.length;\n  var start = 0;\n  var end = len - 1;\n\n  while (end - start > 1) {\n    var middle = Math.floor((start + end) / 2);\n\n    if (valueRange[middle] > x) {\n      end = middle;\n    } else {\n      start = middle;\n    }\n  }\n\n  return x >= valueRange[end] ? end : start;\n}\n\nfunction getIndex(_ref2) {\n  var {\n    startX,\n    endX,\n    scaleValues,\n    gap,\n    data\n  } = _ref2;\n  var lastIndex = data.length - 1;\n  var min = Math.min(startX, endX);\n  var max = Math.max(startX, endX);\n  var minIndex = getIndexInRange(scaleValues, min);\n  var maxIndex = getIndexInRange(scaleValues, max);\n  return {\n    startIndex: minIndex - minIndex % gap,\n    endIndex: maxIndex === lastIndex ? lastIndex : maxIndex - maxIndex % gap\n  };\n}\n\nfunction Background(_ref3) {\n  var {\n    x,\n    y,\n    width,\n    height,\n    fill,\n    stroke\n  } = _ref3;\n  return /*#__PURE__*/React.createElement(\"rect\", {\n    stroke: stroke,\n    fill: fill,\n    x: x,\n    y: y,\n    width: width,\n    height: height\n  });\n}\n\nfunction BrushText(_ref4) {\n  var {\n    startIndex,\n    endIndex,\n    y,\n    height,\n    travellerWidth,\n    stroke,\n    tickFormatter,\n    dataKey,\n    data,\n    startX,\n    endX\n  } = _ref4;\n  var offset = 5;\n  var attrs = {\n    pointerEvents: 'none',\n    fill: stroke\n  };\n  return /*#__PURE__*/React.createElement(Layer, {\n    className: \"recharts-brush-texts\"\n  }, /*#__PURE__*/React.createElement(Text, _extends({\n    textAnchor: \"end\",\n    verticalAnchor: \"middle\",\n    x: Math.min(startX, endX) - offset,\n    y: y + height / 2\n  }, attrs), getTextOfTick({\n    index: startIndex,\n    tickFormatter,\n    dataKey,\n    data\n  })), /*#__PURE__*/React.createElement(Text, _extends({\n    textAnchor: \"start\",\n    verticalAnchor: \"middle\",\n    x: Math.max(startX, endX) + travellerWidth + offset,\n    y: y + height / 2\n  }, attrs), getTextOfTick({\n    index: endIndex,\n    tickFormatter,\n    dataKey,\n    data\n  })));\n}\n\nfunction Slide(_ref5) {\n  var {\n    y,\n    height,\n    stroke,\n    travellerWidth,\n    startX,\n    endX,\n    onMouseEnter,\n    onMouseLeave,\n    onMouseDown,\n    onTouchStart\n  } = _ref5;\n  var x = Math.min(startX, endX) + travellerWidth;\n  var width = Math.max(Math.abs(endX - startX) - travellerWidth, 0);\n  return /*#__PURE__*/React.createElement(\"rect\", {\n    className: \"recharts-brush-slide\",\n    onMouseEnter: onMouseEnter,\n    onMouseLeave: onMouseLeave,\n    onMouseDown: onMouseDown,\n    onTouchStart: onTouchStart,\n    style: {\n      cursor: 'move'\n    },\n    stroke: \"none\",\n    fill: stroke,\n    fillOpacity: 0.2,\n    x: x,\n    y: y,\n    width: width,\n    height: height\n  });\n}\n\nfunction Panorama(_ref6) {\n  var {\n    x,\n    y,\n    width,\n    height,\n    data,\n    children,\n    padding\n  } = _ref6;\n  var isPanoramic = React.Children.count(children) === 1;\n\n  if (!isPanoramic) {\n    return null;\n  }\n\n  var chartElement = Children.only(children);\n\n  if (!chartElement) {\n    return null;\n  }\n\n  return /*#__PURE__*/React.cloneElement(chartElement, {\n    x,\n    y,\n    width,\n    height,\n    margin: padding,\n    compact: true,\n    data\n  });\n}\n\nvar createScale = _ref7 => {\n  var {\n    data,\n    startIndex,\n    endIndex,\n    x,\n    width,\n    travellerWidth\n  } = _ref7;\n\n  if (!data || !data.length) {\n    return {};\n  }\n\n  var len = data.length;\n  var scale = scalePoint().domain(range(0, len)).range([x, x + width - travellerWidth]);\n  var scaleValues = scale.domain().map(entry => scale(entry));\n  return {\n    isTextActive: false,\n    isSlideMoving: false,\n    isTravellerMoving: false,\n    isTravellerFocused: false,\n    startX: scale(startIndex),\n    endX: scale(endIndex),\n    scale,\n    scaleValues\n  };\n};\n\nvar isTouch = e => e.changedTouches && !!e.changedTouches.length;\n\nclass BrushWithState extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _defineProperty(this, \"handleDrag\", e => {\n      if (this.leaveTimer) {\n        clearTimeout(this.leaveTimer);\n        this.leaveTimer = null;\n      }\n\n      if (this.state.isTravellerMoving) {\n        this.handleTravellerMove(e);\n      } else if (this.state.isSlideMoving) {\n        this.handleSlideDrag(e);\n      }\n    });\n\n    _defineProperty(this, \"handleTouchMove\", e => {\n      if (e.changedTouches != null && e.changedTouches.length > 0) {\n        this.handleDrag(e.changedTouches[0]);\n      }\n    });\n\n    _defineProperty(this, \"handleDragEnd\", () => {\n      this.setState({\n        isTravellerMoving: false,\n        isSlideMoving: false\n      }, () => {\n        var {\n          endIndex,\n          onDragEnd,\n          startIndex\n        } = this.props;\n        onDragEnd === null || onDragEnd === void 0 || onDragEnd({\n          endIndex,\n          startIndex\n        });\n      });\n      this.detachDragEndListener();\n    });\n\n    _defineProperty(this, \"handleLeaveWrapper\", () => {\n      if (this.state.isTravellerMoving || this.state.isSlideMoving) {\n        this.leaveTimer = window.setTimeout(this.handleDragEnd, this.props.leaveTimeOut);\n      }\n    });\n\n    _defineProperty(this, \"handleEnterSlideOrTraveller\", () => {\n      this.setState({\n        isTextActive: true\n      });\n    });\n\n    _defineProperty(this, \"handleLeaveSlideOrTraveller\", () => {\n      this.setState({\n        isTextActive: false\n      });\n    });\n\n    _defineProperty(this, \"handleSlideDragStart\", e => {\n      var event = isTouch(e) ? e.changedTouches[0] : e;\n      this.setState({\n        isTravellerMoving: false,\n        isSlideMoving: true,\n        slideMoveStartX: event.pageX\n      });\n      this.attachDragEndListener();\n    });\n\n    _defineProperty(this, \"handleTravellerMoveKeyboard\", (direction, id) => {\n      var {\n        data,\n        gap\n      } = this.props; // scaleValues are a list of coordinates. For example: [65, 250, 435, 620, 805, 990].\n\n      var {\n        scaleValues,\n        startX,\n        endX\n      } = this.state; // currentScaleValue refers to which coordinate the current traveller should be placed at.\n\n      var currentScaleValue = this.state[id];\n      var currentIndex = scaleValues.indexOf(currentScaleValue);\n\n      if (currentIndex === -1) {\n        return;\n      }\n\n      var newIndex = currentIndex + direction;\n\n      if (newIndex === -1 || newIndex >= scaleValues.length) {\n        return;\n      }\n\n      var newScaleValue = scaleValues[newIndex]; // Prevent travellers from being on top of each other or overlapping\n\n      if (id === 'startX' && newScaleValue >= endX || id === 'endX' && newScaleValue <= startX) {\n        return;\n      }\n\n      this.setState({\n        [id]: newScaleValue\n      }, () => {\n        this.props.onChange(getIndex({\n          startX: this.state.startX,\n          endX: this.state.endX,\n          data,\n          gap,\n          scaleValues\n        }));\n      });\n    });\n\n    this.travellerDragStartHandlers = {\n      startX: this.handleTravellerDragStart.bind(this, 'startX'),\n      endX: this.handleTravellerDragStart.bind(this, 'endX')\n    };\n    this.state = {};\n  }\n\n  static getDerivedStateFromProps(nextProps, prevState) {\n    var {\n      data,\n      width,\n      x,\n      travellerWidth,\n      startIndex,\n      endIndex,\n      startIndexControlledFromProps,\n      endIndexControlledFromProps\n    } = nextProps;\n\n    if (data !== prevState.prevData) {\n      return _objectSpread({\n        prevData: data,\n        prevTravellerWidth: travellerWidth,\n        prevX: x,\n        prevWidth: width\n      }, data && data.length ? createScale({\n        data,\n        width,\n        x,\n        travellerWidth,\n        startIndex,\n        endIndex\n      }) : {\n        scale: null,\n        scaleValues: null\n      });\n    }\n\n    if (prevState.scale && (width !== prevState.prevWidth || x !== prevState.prevX || travellerWidth !== prevState.prevTravellerWidth)) {\n      prevState.scale.range([x, x + width - travellerWidth]);\n      var scaleValues = prevState.scale.domain().map(entry => prevState.scale(entry));\n      return {\n        prevData: data,\n        prevTravellerWidth: travellerWidth,\n        prevX: x,\n        prevWidth: width,\n        startX: prevState.scale(nextProps.startIndex),\n        endX: prevState.scale(nextProps.endIndex),\n        scaleValues\n      };\n    }\n\n    if (prevState.scale && !prevState.isSlideMoving && !prevState.isTravellerMoving && !prevState.isTravellerFocused && !prevState.isTextActive) {\n      /*\n       * If the startIndex or endIndex are controlled from the outside,\n       * we need to keep the startX and end up to date.\n       * Also we do not want to do that while user is interacting in the brush,\n       * because this will trigger re-render and interrupt the drag&drop.\n       */\n      if (startIndexControlledFromProps != null && prevState.prevStartIndexControlledFromProps !== startIndexControlledFromProps) {\n        return {\n          startX: prevState.scale(startIndexControlledFromProps),\n          prevStartIndexControlledFromProps: startIndexControlledFromProps\n        };\n      }\n\n      if (endIndexControlledFromProps != null && prevState.prevEndIndexControlledFromProps !== endIndexControlledFromProps) {\n        return {\n          endX: prevState.scale(endIndexControlledFromProps),\n          prevEndIndexControlledFromProps: endIndexControlledFromProps\n        };\n      }\n    }\n\n    return null;\n  }\n\n  componentWillUnmount() {\n    if (this.leaveTimer) {\n      clearTimeout(this.leaveTimer);\n      this.leaveTimer = null;\n    }\n\n    this.detachDragEndListener();\n  }\n\n  attachDragEndListener() {\n    window.addEventListener('mouseup', this.handleDragEnd, true);\n    window.addEventListener('touchend', this.handleDragEnd, true);\n    window.addEventListener('mousemove', this.handleDrag, true);\n  }\n\n  detachDragEndListener() {\n    window.removeEventListener('mouseup', this.handleDragEnd, true);\n    window.removeEventListener('touchend', this.handleDragEnd, true);\n    window.removeEventListener('mousemove', this.handleDrag, true);\n  }\n\n  handleSlideDrag(e) {\n    var {\n      slideMoveStartX,\n      startX,\n      endX,\n      scaleValues\n    } = this.state;\n    var {\n      x,\n      width,\n      travellerWidth,\n      startIndex,\n      endIndex,\n      onChange,\n      data,\n      gap\n    } = this.props;\n    var delta = e.pageX - slideMoveStartX;\n\n    if (delta > 0) {\n      delta = Math.min(delta, x + width - travellerWidth - endX, x + width - travellerWidth - startX);\n    } else if (delta < 0) {\n      delta = Math.max(delta, x - startX, x - endX);\n    }\n\n    var newIndex = getIndex({\n      startX: startX + delta,\n      endX: endX + delta,\n      data,\n      gap,\n      scaleValues\n    });\n\n    if ((newIndex.startIndex !== startIndex || newIndex.endIndex !== endIndex) && onChange) {\n      onChange(newIndex);\n    }\n\n    this.setState({\n      startX: startX + delta,\n      endX: endX + delta,\n      slideMoveStartX: e.pageX\n    });\n  }\n\n  handleTravellerDragStart(id, e) {\n    var event = isTouch(e) ? e.changedTouches[0] : e;\n    this.setState({\n      isSlideMoving: false,\n      isTravellerMoving: true,\n      movingTravellerId: id,\n      brushMoveStartX: event.pageX\n    });\n    this.attachDragEndListener();\n  }\n\n  handleTravellerMove(e) {\n    var {\n      brushMoveStartX,\n      movingTravellerId,\n      endX,\n      startX,\n      scaleValues\n    } = this.state;\n    var prevValue = this.state[movingTravellerId];\n    var {\n      x,\n      width,\n      travellerWidth,\n      onChange,\n      gap,\n      data\n    } = this.props;\n    var params = {\n      startX: this.state.startX,\n      endX: this.state.endX,\n      data,\n      gap,\n      scaleValues\n    };\n    var delta = e.pageX - brushMoveStartX;\n\n    if (delta > 0) {\n      delta = Math.min(delta, x + width - travellerWidth - prevValue);\n    } else if (delta < 0) {\n      delta = Math.max(delta, x - prevValue);\n    }\n\n    params[movingTravellerId] = prevValue + delta;\n    var newIndex = getIndex(params);\n    var {\n      startIndex,\n      endIndex\n    } = newIndex;\n\n    var isFullGap = () => {\n      var lastIndex = data.length - 1;\n\n      if (movingTravellerId === 'startX' && (endX > startX ? startIndex % gap === 0 : endIndex % gap === 0) || endX < startX && endIndex === lastIndex || movingTravellerId === 'endX' && (endX > startX ? endIndex % gap === 0 : startIndex % gap === 0) || endX > startX && endIndex === lastIndex) {\n        return true;\n      }\n\n      return false;\n    };\n\n    this.setState({\n      [movingTravellerId]: prevValue + delta,\n      brushMoveStartX: e.pageX\n    }, () => {\n      if (onChange) {\n        if (isFullGap()) {\n          onChange(newIndex);\n        }\n      }\n    });\n  }\n\n  render() {\n    var {\n      data,\n      className,\n      children,\n      x,\n      y,\n      dy,\n      width,\n      height,\n      alwaysShowText,\n      fill,\n      stroke,\n      startIndex,\n      endIndex,\n      travellerWidth,\n      tickFormatter,\n      dataKey,\n      padding\n    } = this.props;\n    var {\n      startX,\n      endX,\n      isTextActive,\n      isSlideMoving,\n      isTravellerMoving,\n      isTravellerFocused\n    } = this.state;\n\n    if (!data || !data.length || !isNumber(x) || !isNumber(y) || !isNumber(width) || !isNumber(height) || width <= 0 || height <= 0) {\n      return null;\n    }\n\n    var layerClass = clsx('recharts-brush', className);\n    var style = generatePrefixStyle('userSelect', 'none');\n    var calculatedY = y + (dy !== null && dy !== void 0 ? dy : 0);\n    return /*#__PURE__*/React.createElement(Layer, {\n      className: layerClass,\n      onMouseLeave: this.handleLeaveWrapper,\n      onTouchMove: this.handleTouchMove,\n      style: style\n    }, /*#__PURE__*/React.createElement(Background, {\n      x: x,\n      y: calculatedY,\n      width: width,\n      height: height,\n      fill: fill,\n      stroke: stroke\n    }), /*#__PURE__*/React.createElement(PanoramaContextProvider, null, /*#__PURE__*/React.createElement(Panorama, {\n      x: x,\n      y: calculatedY,\n      width: width,\n      height: height,\n      data: data,\n      padding: padding\n    }, children)), /*#__PURE__*/React.createElement(Slide, {\n      y: calculatedY,\n      height: height,\n      stroke: stroke,\n      travellerWidth: travellerWidth,\n      startX: startX,\n      endX: endX,\n      onMouseEnter: this.handleEnterSlideOrTraveller,\n      onMouseLeave: this.handleLeaveSlideOrTraveller,\n      onMouseDown: this.handleSlideDragStart,\n      onTouchStart: this.handleSlideDragStart\n    }), /*#__PURE__*/React.createElement(TravellerLayer, {\n      travellerX: startX,\n      id: \"startX\",\n      otherProps: _objectSpread(_objectSpread({}, this.props), {}, {\n        y: calculatedY\n      }),\n      onMouseEnter: this.handleEnterSlideOrTraveller,\n      onMouseLeave: this.handleLeaveSlideOrTraveller,\n      onMouseDown: this.travellerDragStartHandlers.startX,\n      onTouchStart: this.travellerDragStartHandlers.startX,\n      onTravellerMoveKeyboard: this.handleTravellerMoveKeyboard,\n      onFocus: () => {\n        this.setState({\n          isTravellerFocused: true\n        });\n      },\n      onBlur: () => {\n        this.setState({\n          isTravellerFocused: false\n        });\n      }\n    }), /*#__PURE__*/React.createElement(TravellerLayer, {\n      travellerX: endX,\n      id: \"endX\",\n      otherProps: _objectSpread(_objectSpread({}, this.props), {}, {\n        y: calculatedY\n      }),\n      onMouseEnter: this.handleEnterSlideOrTraveller,\n      onMouseLeave: this.handleLeaveSlideOrTraveller,\n      onMouseDown: this.travellerDragStartHandlers.endX,\n      onTouchStart: this.travellerDragStartHandlers.endX,\n      onTravellerMoveKeyboard: this.handleTravellerMoveKeyboard,\n      onFocus: () => {\n        this.setState({\n          isTravellerFocused: true\n        });\n      },\n      onBlur: () => {\n        this.setState({\n          isTravellerFocused: false\n        });\n      }\n    }), (isTextActive || isSlideMoving || isTravellerMoving || isTravellerFocused || alwaysShowText) && /*#__PURE__*/React.createElement(BrushText, {\n      startIndex: startIndex,\n      endIndex: endIndex,\n      y: calculatedY,\n      height: height,\n      travellerWidth: travellerWidth,\n      stroke: stroke,\n      tickFormatter: tickFormatter,\n      dataKey: dataKey,\n      data: data,\n      startX: startX,\n      endX: endX\n    }));\n  }\n\n}\n\nfunction BrushInternal(props) {\n  var dispatch = useAppDispatch();\n  var chartData = useChartData();\n  var {\n    startIndex,\n    endIndex\n  } = useDataIndex();\n  var onChangeFromContext = useContext(BrushUpdateDispatchContext);\n  var onChangeFromProps = props.onChange;\n  var {\n    startIndex: startIndexFromProps,\n    endIndex: endIndexFromProps\n  } = props;\n  useEffect(() => {\n    // start and end index can be controlled from props, and we need them to stay up-to-date in the Redux state too\n    dispatch(setDataStartEndIndexes({\n      startIndex: startIndexFromProps,\n      endIndex: endIndexFromProps\n    }));\n  }, [dispatch, endIndexFromProps, startIndexFromProps]);\n  useBrushChartSynchronisation();\n  var onChange = useCallback(nextState => {\n    if (nextState.startIndex !== startIndex || nextState.endIndex !== endIndex) {\n      onChangeFromContext === null || onChangeFromContext === void 0 || onChangeFromContext(nextState);\n      onChangeFromProps === null || onChangeFromProps === void 0 || onChangeFromProps(nextState);\n      dispatch(setDataStartEndIndexes(nextState));\n    }\n  }, [onChangeFromProps, onChangeFromContext, dispatch, startIndex, endIndex]);\n  var {\n    x,\n    y,\n    width\n  } = useAppSelector(selectBrushDimensions);\n  var contextProperties = {\n    data: chartData,\n    x,\n    y,\n    width,\n    startIndex,\n    endIndex,\n    onChange\n  };\n  return /*#__PURE__*/React.createElement(BrushWithState, _extends({}, props, contextProperties, {\n    startIndexControlledFromProps: startIndexFromProps !== null && startIndexFromProps !== void 0 ? startIndexFromProps : undefined,\n    endIndexControlledFromProps: endIndexFromProps !== null && endIndexFromProps !== void 0 ? endIndexFromProps : undefined\n  }));\n}\n\nfunction BrushSettingsDispatcher(props) {\n  var dispatch = useAppDispatch();\n  useEffect(() => {\n    dispatch(setBrushSettings(props));\n    return () => {\n      dispatch(setBrushSettings(null));\n    };\n  }, [dispatch, props]);\n  return null;\n}\n\nexport class Brush extends PureComponent {\n  render() {\n    return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(BrushSettingsDispatcher, {\n      height: this.props.height,\n      x: this.props.x,\n      y: this.props.y,\n      width: this.props.width,\n      padding: this.props.padding\n    }), /*#__PURE__*/React.createElement(BrushInternal, this.props));\n  }\n\n}\n\n_defineProperty(Brush, \"displayName\", 'Brush');\n\n_defineProperty(Brush, \"defaultProps\", {\n  height: 40,\n  travellerWidth: 5,\n  gap: 1,\n  fill: '#fff',\n  stroke: '#666',\n  padding: {\n    top: 1,\n    right: 1,\n    bottom: 1,\n    left: 1\n  },\n  leaveTimeOut: 1000,\n  alwaysShowText: false\n});","map":{"version":3,"sources":["/Users/emiliamamedova/charts/project_corona_tracker/node_modules/recharts/es6/cartesian/Brush.js"],"names":["_extends","Object","assign","bind","n","e","arguments","length","t","r","hasOwnProperty","call","apply","ownKeys","keys","getOwnPropertySymbols","o","filter","getOwnPropertyDescriptor","enumerable","push","_objectSpread","forEach","_defineProperty","getOwnPropertyDescriptors","defineProperties","defineProperty","_toPropertyKey","value","configurable","writable","i","_toPrimitive","Symbol","toPrimitive","TypeError","String","Number","React","Children","PureComponent","useCallback","useContext","useEffect","clsx","scalePoint","range","Layer","Text","getValueByDataKey","isNumber","generatePrefixStyle","filterProps","useChartData","useDataIndex","BrushUpdateDispatchContext","useAppDispatch","useAppSelector","setDataStartEndIndexes","setBrushSettings","PanoramaContextProvider","selectBrushDimensions","useBrushChartSynchronisation","DefaultTraveller","props","x","y","width","height","stroke","lineY","Math","floor","createElement","Fragment","fill","x1","y1","x2","y2","Traveller","travellerProps","travellerType","isValidElement","cloneElement","TravellerLayer","_ref","_data$startIndex","_data$endIndex","otherProps","travellerX","id","onMouseEnter","onMouseLeave","onMouseDown","onTouchStart","onTravellerMoveKeyboard","onFocus","onBlur","xFromProps","travellerWidth","traveller","ariaLabel","data","startIndex","endIndex","max","ariaLabelBrush","concat","name","tabIndex","role","className","onKeyDown","includes","key","preventDefault","stopPropagation","style","cursor","getTextOfTick","index","tickFormatter","dataKey","text","getIndexInRange","valueRange","len","start","end","middle","getIndex","_ref2","startX","endX","scaleValues","gap","lastIndex","min","minIndex","maxIndex","Background","_ref3","BrushText","_ref4","offset","attrs","pointerEvents","textAnchor","verticalAnchor","Slide","_ref5","abs","fillOpacity","Panorama","_ref6","children","padding","isPanoramic","count","chartElement","only","margin","compact","createScale","_ref7","scale","domain","map","entry","isTextActive","isSlideMoving","isTravellerMoving","isTravellerFocused","isTouch","changedTouches","BrushWithState","constructor","leaveTimer","clearTimeout","state","handleTravellerMove","handleSlideDrag","handleDrag","setState","onDragEnd","detachDragEndListener","window","setTimeout","handleDragEnd","leaveTimeOut","event","slideMoveStartX","pageX","attachDragEndListener","direction","currentScaleValue","currentIndex","indexOf","newIndex","newScaleValue","onChange","travellerDragStartHandlers","handleTravellerDragStart","getDerivedStateFromProps","nextProps","prevState","startIndexControlledFromProps","endIndexControlledFromProps","prevData","prevTravellerWidth","prevX","prevWidth","prevStartIndexControlledFromProps","prevEndIndexControlledFromProps","componentWillUnmount","addEventListener","removeEventListener","delta","movingTravellerId","brushMoveStartX","prevValue","params","isFullGap","render","dy","alwaysShowText","layerClass","calculatedY","handleLeaveWrapper","onTouchMove","handleTouchMove","handleEnterSlideOrTraveller","handleLeaveSlideOrTraveller","handleSlideDragStart","handleTravellerMoveKeyboard","BrushInternal","dispatch","chartData","onChangeFromContext","onChangeFromProps","startIndexFromProps","endIndexFromProps","nextState","contextProperties","undefined","BrushSettingsDispatcher","Brush","top","right","bottom","left"],"mappings":"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","sourcesContent":["function _extends() { return _extends = Object.assign ? Object.assign.bind() : function (n) { for (var e = 1; e < arguments.length; e++) { var t = arguments[e]; for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]); } return n; }, _extends.apply(null, arguments); }\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nfunction _defineProperty(e, r, t) { return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, { value: t, enumerable: !0, configurable: !0, writable: !0 }) : e[r] = t, e; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == typeof i ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != typeof t || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != typeof i) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\n/*\n * After we refactor classes to functional components, we can remove this eslint-disable\n */\n/* eslint-disable max-classes-per-file */\nimport * as React from 'react';\nimport { Children, PureComponent, useCallback, useContext, useEffect } from 'react';\nimport { clsx } from 'clsx';\nimport { scalePoint } from 'victory-vendor/d3-scale';\nimport range from 'es-toolkit/compat/range';\nimport { Layer } from '../container/Layer';\nimport { Text } from '../component/Text';\nimport { getValueByDataKey } from '../util/ChartUtils';\nimport { isNumber } from '../util/DataUtils';\nimport { generatePrefixStyle } from '../util/CssPrefixUtils';\nimport { filterProps } from '../util/ReactUtils';\nimport { useChartData, useDataIndex } from '../context/chartDataContext';\nimport { BrushUpdateDispatchContext } from '../context/brushUpdateContext';\nimport { useAppDispatch, useAppSelector } from '../state/hooks';\nimport { setDataStartEndIndexes } from '../state/chartDataSlice';\nimport { setBrushSettings } from '../state/brushSlice';\nimport { PanoramaContextProvider } from '../context/PanoramaContext';\nimport { selectBrushDimensions } from '../state/selectors/brushSelectors';\nimport { useBrushChartSynchronisation } from '../synchronisation/useChartSynchronisation';\n\n// Why is this tickFormatter different from the other TickFormatters? This one allows to return numbers too for some reason.\n\nfunction DefaultTraveller(props) {\n  var {\n    x,\n    y,\n    width,\n    height,\n    stroke\n  } = props;\n  var lineY = Math.floor(y + height / 2) - 1;\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"rect\", {\n    x: x,\n    y: y,\n    width: width,\n    height: height,\n    fill: stroke,\n    stroke: \"none\"\n  }), /*#__PURE__*/React.createElement(\"line\", {\n    x1: x + 1,\n    y1: lineY,\n    x2: x + width - 1,\n    y2: lineY,\n    fill: \"none\",\n    stroke: \"#fff\"\n  }), /*#__PURE__*/React.createElement(\"line\", {\n    x1: x + 1,\n    y1: lineY + 2,\n    x2: x + width - 1,\n    y2: lineY + 2,\n    fill: \"none\",\n    stroke: \"#fff\"\n  }));\n}\nfunction Traveller(props) {\n  var {\n    travellerProps,\n    travellerType\n  } = props;\n  if (/*#__PURE__*/React.isValidElement(travellerType)) {\n    // @ts-expect-error element cloning disagrees with the types (and it should)\n    return /*#__PURE__*/React.cloneElement(travellerType, travellerProps);\n  }\n  if (typeof travellerType === 'function') {\n    return travellerType(travellerProps);\n  }\n  return /*#__PURE__*/React.createElement(DefaultTraveller, travellerProps);\n}\nfunction TravellerLayer(_ref) {\n  var _data$startIndex, _data$endIndex;\n  var {\n    otherProps,\n    travellerX,\n    id,\n    onMouseEnter,\n    onMouseLeave,\n    onMouseDown,\n    onTouchStart,\n    onTravellerMoveKeyboard,\n    onFocus,\n    onBlur\n  } = _ref;\n  var {\n    y,\n    x: xFromProps,\n    travellerWidth,\n    height,\n    traveller,\n    ariaLabel,\n    data,\n    startIndex,\n    endIndex\n  } = otherProps;\n  var x = Math.max(travellerX, xFromProps);\n  var travellerProps = _objectSpread(_objectSpread({}, filterProps(otherProps, false)), {}, {\n    x,\n    y,\n    width: travellerWidth,\n    height\n  });\n  var ariaLabelBrush = ariaLabel || \"Min value: \".concat((_data$startIndex = data[startIndex]) === null || _data$startIndex === void 0 ? void 0 : _data$startIndex.name, \", Max value: \").concat((_data$endIndex = data[endIndex]) === null || _data$endIndex === void 0 ? void 0 : _data$endIndex.name);\n  return /*#__PURE__*/React.createElement(Layer, {\n    tabIndex: 0,\n    role: \"slider\",\n    \"aria-label\": ariaLabelBrush,\n    \"aria-valuenow\": travellerX,\n    className: \"recharts-brush-traveller\",\n    onMouseEnter: onMouseEnter,\n    onMouseLeave: onMouseLeave,\n    onMouseDown: onMouseDown,\n    onTouchStart: onTouchStart,\n    onKeyDown: e => {\n      if (!['ArrowLeft', 'ArrowRight'].includes(e.key)) {\n        return;\n      }\n      e.preventDefault();\n      e.stopPropagation();\n      onTravellerMoveKeyboard(e.key === 'ArrowRight' ? 1 : -1, id);\n    },\n    onFocus: onFocus,\n    onBlur: onBlur,\n    style: {\n      cursor: 'col-resize'\n    }\n  }, /*#__PURE__*/React.createElement(Traveller, {\n    travellerType: traveller,\n    travellerProps: travellerProps\n  }));\n}\n/*\n * This one cannot be a React Component because React is not happy with it returning only string | number.\n * React wants a full React.JSX.Element but that is not compatible with Text component.\n */\nfunction getTextOfTick(props) {\n  var {\n    index,\n    data,\n    tickFormatter,\n    dataKey\n  } = props;\n  var text = getValueByDataKey(data[index], dataKey, index);\n\n  // @ts-expect-error getValueByDataKey does not validate the output type\n  return typeof tickFormatter === 'function' ? tickFormatter(text, index) : text;\n}\nfunction getIndexInRange(valueRange, x) {\n  var len = valueRange.length;\n  var start = 0;\n  var end = len - 1;\n  while (end - start > 1) {\n    var middle = Math.floor((start + end) / 2);\n    if (valueRange[middle] > x) {\n      end = middle;\n    } else {\n      start = middle;\n    }\n  }\n  return x >= valueRange[end] ? end : start;\n}\nfunction getIndex(_ref2) {\n  var {\n    startX,\n    endX,\n    scaleValues,\n    gap,\n    data\n  } = _ref2;\n  var lastIndex = data.length - 1;\n  var min = Math.min(startX, endX);\n  var max = Math.max(startX, endX);\n  var minIndex = getIndexInRange(scaleValues, min);\n  var maxIndex = getIndexInRange(scaleValues, max);\n  return {\n    startIndex: minIndex - minIndex % gap,\n    endIndex: maxIndex === lastIndex ? lastIndex : maxIndex - maxIndex % gap\n  };\n}\nfunction Background(_ref3) {\n  var {\n    x,\n    y,\n    width,\n    height,\n    fill,\n    stroke\n  } = _ref3;\n  return /*#__PURE__*/React.createElement(\"rect\", {\n    stroke: stroke,\n    fill: fill,\n    x: x,\n    y: y,\n    width: width,\n    height: height\n  });\n}\nfunction BrushText(_ref4) {\n  var {\n    startIndex,\n    endIndex,\n    y,\n    height,\n    travellerWidth,\n    stroke,\n    tickFormatter,\n    dataKey,\n    data,\n    startX,\n    endX\n  } = _ref4;\n  var offset = 5;\n  var attrs = {\n    pointerEvents: 'none',\n    fill: stroke\n  };\n  return /*#__PURE__*/React.createElement(Layer, {\n    className: \"recharts-brush-texts\"\n  }, /*#__PURE__*/React.createElement(Text, _extends({\n    textAnchor: \"end\",\n    verticalAnchor: \"middle\",\n    x: Math.min(startX, endX) - offset,\n    y: y + height / 2\n  }, attrs), getTextOfTick({\n    index: startIndex,\n    tickFormatter,\n    dataKey,\n    data\n  })), /*#__PURE__*/React.createElement(Text, _extends({\n    textAnchor: \"start\",\n    verticalAnchor: \"middle\",\n    x: Math.max(startX, endX) + travellerWidth + offset,\n    y: y + height / 2\n  }, attrs), getTextOfTick({\n    index: endIndex,\n    tickFormatter,\n    dataKey,\n    data\n  })));\n}\nfunction Slide(_ref5) {\n  var {\n    y,\n    height,\n    stroke,\n    travellerWidth,\n    startX,\n    endX,\n    onMouseEnter,\n    onMouseLeave,\n    onMouseDown,\n    onTouchStart\n  } = _ref5;\n  var x = Math.min(startX, endX) + travellerWidth;\n  var width = Math.max(Math.abs(endX - startX) - travellerWidth, 0);\n  return /*#__PURE__*/React.createElement(\"rect\", {\n    className: \"recharts-brush-slide\",\n    onMouseEnter: onMouseEnter,\n    onMouseLeave: onMouseLeave,\n    onMouseDown: onMouseDown,\n    onTouchStart: onTouchStart,\n    style: {\n      cursor: 'move'\n    },\n    stroke: \"none\",\n    fill: stroke,\n    fillOpacity: 0.2,\n    x: x,\n    y: y,\n    width: width,\n    height: height\n  });\n}\nfunction Panorama(_ref6) {\n  var {\n    x,\n    y,\n    width,\n    height,\n    data,\n    children,\n    padding\n  } = _ref6;\n  var isPanoramic = React.Children.count(children) === 1;\n  if (!isPanoramic) {\n    return null;\n  }\n  var chartElement = Children.only(children);\n  if (!chartElement) {\n    return null;\n  }\n  return /*#__PURE__*/React.cloneElement(chartElement, {\n    x,\n    y,\n    width,\n    height,\n    margin: padding,\n    compact: true,\n    data\n  });\n}\nvar createScale = _ref7 => {\n  var {\n    data,\n    startIndex,\n    endIndex,\n    x,\n    width,\n    travellerWidth\n  } = _ref7;\n  if (!data || !data.length) {\n    return {};\n  }\n  var len = data.length;\n  var scale = scalePoint().domain(range(0, len)).range([x, x + width - travellerWidth]);\n  var scaleValues = scale.domain().map(entry => scale(entry));\n  return {\n    isTextActive: false,\n    isSlideMoving: false,\n    isTravellerMoving: false,\n    isTravellerFocused: false,\n    startX: scale(startIndex),\n    endX: scale(endIndex),\n    scale,\n    scaleValues\n  };\n};\nvar isTouch = e => e.changedTouches && !!e.changedTouches.length;\nclass BrushWithState extends PureComponent {\n  constructor(props) {\n    super(props);\n    _defineProperty(this, \"handleDrag\", e => {\n      if (this.leaveTimer) {\n        clearTimeout(this.leaveTimer);\n        this.leaveTimer = null;\n      }\n      if (this.state.isTravellerMoving) {\n        this.handleTravellerMove(e);\n      } else if (this.state.isSlideMoving) {\n        this.handleSlideDrag(e);\n      }\n    });\n    _defineProperty(this, \"handleTouchMove\", e => {\n      if (e.changedTouches != null && e.changedTouches.length > 0) {\n        this.handleDrag(e.changedTouches[0]);\n      }\n    });\n    _defineProperty(this, \"handleDragEnd\", () => {\n      this.setState({\n        isTravellerMoving: false,\n        isSlideMoving: false\n      }, () => {\n        var {\n          endIndex,\n          onDragEnd,\n          startIndex\n        } = this.props;\n        onDragEnd === null || onDragEnd === void 0 || onDragEnd({\n          endIndex,\n          startIndex\n        });\n      });\n      this.detachDragEndListener();\n    });\n    _defineProperty(this, \"handleLeaveWrapper\", () => {\n      if (this.state.isTravellerMoving || this.state.isSlideMoving) {\n        this.leaveTimer = window.setTimeout(this.handleDragEnd, this.props.leaveTimeOut);\n      }\n    });\n    _defineProperty(this, \"handleEnterSlideOrTraveller\", () => {\n      this.setState({\n        isTextActive: true\n      });\n    });\n    _defineProperty(this, \"handleLeaveSlideOrTraveller\", () => {\n      this.setState({\n        isTextActive: false\n      });\n    });\n    _defineProperty(this, \"handleSlideDragStart\", e => {\n      var event = isTouch(e) ? e.changedTouches[0] : e;\n      this.setState({\n        isTravellerMoving: false,\n        isSlideMoving: true,\n        slideMoveStartX: event.pageX\n      });\n      this.attachDragEndListener();\n    });\n    _defineProperty(this, \"handleTravellerMoveKeyboard\", (direction, id) => {\n      var {\n        data,\n        gap\n      } = this.props;\n      // scaleValues are a list of coordinates. For example: [65, 250, 435, 620, 805, 990].\n      var {\n        scaleValues,\n        startX,\n        endX\n      } = this.state;\n      // currentScaleValue refers to which coordinate the current traveller should be placed at.\n      var currentScaleValue = this.state[id];\n      var currentIndex = scaleValues.indexOf(currentScaleValue);\n      if (currentIndex === -1) {\n        return;\n      }\n      var newIndex = currentIndex + direction;\n      if (newIndex === -1 || newIndex >= scaleValues.length) {\n        return;\n      }\n      var newScaleValue = scaleValues[newIndex];\n\n      // Prevent travellers from being on top of each other or overlapping\n      if (id === 'startX' && newScaleValue >= endX || id === 'endX' && newScaleValue <= startX) {\n        return;\n      }\n      this.setState({\n        [id]: newScaleValue\n      }, () => {\n        this.props.onChange(getIndex({\n          startX: this.state.startX,\n          endX: this.state.endX,\n          data,\n          gap,\n          scaleValues\n        }));\n      });\n    });\n    this.travellerDragStartHandlers = {\n      startX: this.handleTravellerDragStart.bind(this, 'startX'),\n      endX: this.handleTravellerDragStart.bind(this, 'endX')\n    };\n    this.state = {};\n  }\n  static getDerivedStateFromProps(nextProps, prevState) {\n    var {\n      data,\n      width,\n      x,\n      travellerWidth,\n      startIndex,\n      endIndex,\n      startIndexControlledFromProps,\n      endIndexControlledFromProps\n    } = nextProps;\n    if (data !== prevState.prevData) {\n      return _objectSpread({\n        prevData: data,\n        prevTravellerWidth: travellerWidth,\n        prevX: x,\n        prevWidth: width\n      }, data && data.length ? createScale({\n        data,\n        width,\n        x,\n        travellerWidth,\n        startIndex,\n        endIndex\n      }) : {\n        scale: null,\n        scaleValues: null\n      });\n    }\n    if (prevState.scale && (width !== prevState.prevWidth || x !== prevState.prevX || travellerWidth !== prevState.prevTravellerWidth)) {\n      prevState.scale.range([x, x + width - travellerWidth]);\n      var scaleValues = prevState.scale.domain().map(entry => prevState.scale(entry));\n      return {\n        prevData: data,\n        prevTravellerWidth: travellerWidth,\n        prevX: x,\n        prevWidth: width,\n        startX: prevState.scale(nextProps.startIndex),\n        endX: prevState.scale(nextProps.endIndex),\n        scaleValues\n      };\n    }\n    if (prevState.scale && !prevState.isSlideMoving && !prevState.isTravellerMoving && !prevState.isTravellerFocused && !prevState.isTextActive) {\n      /*\n       * If the startIndex or endIndex are controlled from the outside,\n       * we need to keep the startX and end up to date.\n       * Also we do not want to do that while user is interacting in the brush,\n       * because this will trigger re-render and interrupt the drag&drop.\n       */\n      if (startIndexControlledFromProps != null && prevState.prevStartIndexControlledFromProps !== startIndexControlledFromProps) {\n        return {\n          startX: prevState.scale(startIndexControlledFromProps),\n          prevStartIndexControlledFromProps: startIndexControlledFromProps\n        };\n      }\n      if (endIndexControlledFromProps != null && prevState.prevEndIndexControlledFromProps !== endIndexControlledFromProps) {\n        return {\n          endX: prevState.scale(endIndexControlledFromProps),\n          prevEndIndexControlledFromProps: endIndexControlledFromProps\n        };\n      }\n    }\n    return null;\n  }\n  componentWillUnmount() {\n    if (this.leaveTimer) {\n      clearTimeout(this.leaveTimer);\n      this.leaveTimer = null;\n    }\n    this.detachDragEndListener();\n  }\n  attachDragEndListener() {\n    window.addEventListener('mouseup', this.handleDragEnd, true);\n    window.addEventListener('touchend', this.handleDragEnd, true);\n    window.addEventListener('mousemove', this.handleDrag, true);\n  }\n  detachDragEndListener() {\n    window.removeEventListener('mouseup', this.handleDragEnd, true);\n    window.removeEventListener('touchend', this.handleDragEnd, true);\n    window.removeEventListener('mousemove', this.handleDrag, true);\n  }\n  handleSlideDrag(e) {\n    var {\n      slideMoveStartX,\n      startX,\n      endX,\n      scaleValues\n    } = this.state;\n    var {\n      x,\n      width,\n      travellerWidth,\n      startIndex,\n      endIndex,\n      onChange,\n      data,\n      gap\n    } = this.props;\n    var delta = e.pageX - slideMoveStartX;\n    if (delta > 0) {\n      delta = Math.min(delta, x + width - travellerWidth - endX, x + width - travellerWidth - startX);\n    } else if (delta < 0) {\n      delta = Math.max(delta, x - startX, x - endX);\n    }\n    var newIndex = getIndex({\n      startX: startX + delta,\n      endX: endX + delta,\n      data,\n      gap,\n      scaleValues\n    });\n    if ((newIndex.startIndex !== startIndex || newIndex.endIndex !== endIndex) && onChange) {\n      onChange(newIndex);\n    }\n    this.setState({\n      startX: startX + delta,\n      endX: endX + delta,\n      slideMoveStartX: e.pageX\n    });\n  }\n  handleTravellerDragStart(id, e) {\n    var event = isTouch(e) ? e.changedTouches[0] : e;\n    this.setState({\n      isSlideMoving: false,\n      isTravellerMoving: true,\n      movingTravellerId: id,\n      brushMoveStartX: event.pageX\n    });\n    this.attachDragEndListener();\n  }\n  handleTravellerMove(e) {\n    var {\n      brushMoveStartX,\n      movingTravellerId,\n      endX,\n      startX,\n      scaleValues\n    } = this.state;\n    var prevValue = this.state[movingTravellerId];\n    var {\n      x,\n      width,\n      travellerWidth,\n      onChange,\n      gap,\n      data\n    } = this.props;\n    var params = {\n      startX: this.state.startX,\n      endX: this.state.endX,\n      data,\n      gap,\n      scaleValues\n    };\n    var delta = e.pageX - brushMoveStartX;\n    if (delta > 0) {\n      delta = Math.min(delta, x + width - travellerWidth - prevValue);\n    } else if (delta < 0) {\n      delta = Math.max(delta, x - prevValue);\n    }\n    params[movingTravellerId] = prevValue + delta;\n    var newIndex = getIndex(params);\n    var {\n      startIndex,\n      endIndex\n    } = newIndex;\n    var isFullGap = () => {\n      var lastIndex = data.length - 1;\n      if (movingTravellerId === 'startX' && (endX > startX ? startIndex % gap === 0 : endIndex % gap === 0) || endX < startX && endIndex === lastIndex || movingTravellerId === 'endX' && (endX > startX ? endIndex % gap === 0 : startIndex % gap === 0) || endX > startX && endIndex === lastIndex) {\n        return true;\n      }\n      return false;\n    };\n    this.setState({\n      [movingTravellerId]: prevValue + delta,\n      brushMoveStartX: e.pageX\n    }, () => {\n      if (onChange) {\n        if (isFullGap()) {\n          onChange(newIndex);\n        }\n      }\n    });\n  }\n  render() {\n    var {\n      data,\n      className,\n      children,\n      x,\n      y,\n      dy,\n      width,\n      height,\n      alwaysShowText,\n      fill,\n      stroke,\n      startIndex,\n      endIndex,\n      travellerWidth,\n      tickFormatter,\n      dataKey,\n      padding\n    } = this.props;\n    var {\n      startX,\n      endX,\n      isTextActive,\n      isSlideMoving,\n      isTravellerMoving,\n      isTravellerFocused\n    } = this.state;\n    if (!data || !data.length || !isNumber(x) || !isNumber(y) || !isNumber(width) || !isNumber(height) || width <= 0 || height <= 0) {\n      return null;\n    }\n    var layerClass = clsx('recharts-brush', className);\n    var style = generatePrefixStyle('userSelect', 'none');\n    var calculatedY = y + (dy !== null && dy !== void 0 ? dy : 0);\n    return /*#__PURE__*/React.createElement(Layer, {\n      className: layerClass,\n      onMouseLeave: this.handleLeaveWrapper,\n      onTouchMove: this.handleTouchMove,\n      style: style\n    }, /*#__PURE__*/React.createElement(Background, {\n      x: x,\n      y: calculatedY,\n      width: width,\n      height: height,\n      fill: fill,\n      stroke: stroke\n    }), /*#__PURE__*/React.createElement(PanoramaContextProvider, null, /*#__PURE__*/React.createElement(Panorama, {\n      x: x,\n      y: calculatedY,\n      width: width,\n      height: height,\n      data: data,\n      padding: padding\n    }, children)), /*#__PURE__*/React.createElement(Slide, {\n      y: calculatedY,\n      height: height,\n      stroke: stroke,\n      travellerWidth: travellerWidth,\n      startX: startX,\n      endX: endX,\n      onMouseEnter: this.handleEnterSlideOrTraveller,\n      onMouseLeave: this.handleLeaveSlideOrTraveller,\n      onMouseDown: this.handleSlideDragStart,\n      onTouchStart: this.handleSlideDragStart\n    }), /*#__PURE__*/React.createElement(TravellerLayer, {\n      travellerX: startX,\n      id: \"startX\",\n      otherProps: _objectSpread(_objectSpread({}, this.props), {}, {\n        y: calculatedY\n      }),\n      onMouseEnter: this.handleEnterSlideOrTraveller,\n      onMouseLeave: this.handleLeaveSlideOrTraveller,\n      onMouseDown: this.travellerDragStartHandlers.startX,\n      onTouchStart: this.travellerDragStartHandlers.startX,\n      onTravellerMoveKeyboard: this.handleTravellerMoveKeyboard,\n      onFocus: () => {\n        this.setState({\n          isTravellerFocused: true\n        });\n      },\n      onBlur: () => {\n        this.setState({\n          isTravellerFocused: false\n        });\n      }\n    }), /*#__PURE__*/React.createElement(TravellerLayer, {\n      travellerX: endX,\n      id: \"endX\",\n      otherProps: _objectSpread(_objectSpread({}, this.props), {}, {\n        y: calculatedY\n      }),\n      onMouseEnter: this.handleEnterSlideOrTraveller,\n      onMouseLeave: this.handleLeaveSlideOrTraveller,\n      onMouseDown: this.travellerDragStartHandlers.endX,\n      onTouchStart: this.travellerDragStartHandlers.endX,\n      onTravellerMoveKeyboard: this.handleTravellerMoveKeyboard,\n      onFocus: () => {\n        this.setState({\n          isTravellerFocused: true\n        });\n      },\n      onBlur: () => {\n        this.setState({\n          isTravellerFocused: false\n        });\n      }\n    }), (isTextActive || isSlideMoving || isTravellerMoving || isTravellerFocused || alwaysShowText) && /*#__PURE__*/React.createElement(BrushText, {\n      startIndex: startIndex,\n      endIndex: endIndex,\n      y: calculatedY,\n      height: height,\n      travellerWidth: travellerWidth,\n      stroke: stroke,\n      tickFormatter: tickFormatter,\n      dataKey: dataKey,\n      data: data,\n      startX: startX,\n      endX: endX\n    }));\n  }\n}\nfunction BrushInternal(props) {\n  var dispatch = useAppDispatch();\n  var chartData = useChartData();\n  var {\n    startIndex,\n    endIndex\n  } = useDataIndex();\n  var onChangeFromContext = useContext(BrushUpdateDispatchContext);\n  var onChangeFromProps = props.onChange;\n  var {\n    startIndex: startIndexFromProps,\n    endIndex: endIndexFromProps\n  } = props;\n  useEffect(() => {\n    // start and end index can be controlled from props, and we need them to stay up-to-date in the Redux state too\n    dispatch(setDataStartEndIndexes({\n      startIndex: startIndexFromProps,\n      endIndex: endIndexFromProps\n    }));\n  }, [dispatch, endIndexFromProps, startIndexFromProps]);\n  useBrushChartSynchronisation();\n  var onChange = useCallback(nextState => {\n    if (nextState.startIndex !== startIndex || nextState.endIndex !== endIndex) {\n      onChangeFromContext === null || onChangeFromContext === void 0 || onChangeFromContext(nextState);\n      onChangeFromProps === null || onChangeFromProps === void 0 || onChangeFromProps(nextState);\n      dispatch(setDataStartEndIndexes(nextState));\n    }\n  }, [onChangeFromProps, onChangeFromContext, dispatch, startIndex, endIndex]);\n  var {\n    x,\n    y,\n    width\n  } = useAppSelector(selectBrushDimensions);\n  var contextProperties = {\n    data: chartData,\n    x,\n    y,\n    width,\n    startIndex,\n    endIndex,\n    onChange\n  };\n  return /*#__PURE__*/React.createElement(BrushWithState, _extends({}, props, contextProperties, {\n    startIndexControlledFromProps: startIndexFromProps !== null && startIndexFromProps !== void 0 ? startIndexFromProps : undefined,\n    endIndexControlledFromProps: endIndexFromProps !== null && endIndexFromProps !== void 0 ? endIndexFromProps : undefined\n  }));\n}\nfunction BrushSettingsDispatcher(props) {\n  var dispatch = useAppDispatch();\n  useEffect(() => {\n    dispatch(setBrushSettings(props));\n    return () => {\n      dispatch(setBrushSettings(null));\n    };\n  }, [dispatch, props]);\n  return null;\n}\nexport class Brush extends PureComponent {\n  render() {\n    return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(BrushSettingsDispatcher, {\n      height: this.props.height,\n      x: this.props.x,\n      y: this.props.y,\n      width: this.props.width,\n      padding: this.props.padding\n    }), /*#__PURE__*/React.createElement(BrushInternal, this.props));\n  }\n}\n_defineProperty(Brush, \"displayName\", 'Brush');\n_defineProperty(Brush, \"defaultProps\", {\n  height: 40,\n  travellerWidth: 5,\n  gap: 1,\n  fill: '#fff',\n  stroke: '#666',\n  padding: {\n    top: 1,\n    right: 1,\n    bottom: 1,\n    left: 1\n  },\n  leaveTimeOut: 1000,\n  alwaysShowText: false\n});"]},"metadata":{},"sourceType":"module"}